
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="介绍物联网基础概念">
      
      
      
        <meta name="author" content="WiSys Lob">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.0">
    
    
      
        <title>8.7 简单无线通信系统的实现 - IoT Book</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bc7e593a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab28b872.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="IoT Book" class="md-header-nav__button md-logo" aria-label="IoT Book">
      
  <img src="../../images/nicon.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            IoT Book
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              8.7 简单无线通信系统的实现
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IoT Book" class="md-nav__button md-logo" aria-label="IoT Book">
      
  <img src="../../images/nicon.png" alt="logo">

    </a>
    IoT Book
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../CH0_Front/%E5%89%8D%E6%B2%BF2/" class="md-nav__link">
      第2版前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../1.%20%E5%89%8D%E8%A8%80/%E7%89%A9%E8%81%94%E7%BD%91%E5%AF%BC%E8%AE%BA/" class="md-nav__link">
      第1版前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      第1章 物联网概述
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第1章 物联网概述" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        第1章 物联网概述
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2.%20%E7%89%A9%E8%81%94%E7%BD%91%E7%AE%80%E4%BB%8B/%E7%89%A9%E8%81%94%E7%BD%91%E7%AE%80%E4%BB%8B/" class="md-nav__link">
      1.1 起源与发展
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      第2章 物联网开发
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第2章 物联网开发" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        第2章 物联网开发
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../3.%20%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA/android%E5%BC%80%E5%8F%91%E5%9F%BA%E7%A1%80/" class="md-nav__link">
      2.1 Android 环境
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3.%20%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA/matlab%E5%9F%BA%E7%A1%80/" class="md-nav__link">
      2.2 MATLAB 环境
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      第3章 物联网网络协议
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第3章 物联网网络协议" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        第3章 物联网网络协议
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/%E7%89%A9%E8%81%94%E7%BD%91%E8%BF%9E%E6%8E%A5%E6%8A%80%E6%9C%AF/" class="md-nav__link">
      3.1 物联网连接技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/4.2%20Wi-Fi%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91/" class="md-nav__link">
      3.2 Wi-Fi无线局域网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/4.3%20%E8%93%9D%E7%89%99/" class="md-nav__link">
      3.3 蓝牙
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/4.4%20ZigBee/" class="md-nav__link">
      3.4 ZigBee
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/4.5%20%E6%AF%AB%E7%B1%B3%E6%B3%A2%E9%80%9A%E4%BF%A1/" class="md-nav__link">
      3.5 毫米波通信
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/4.6%20%E5%8F%AF%E8%A7%81%E5%85%89%E9%80%9A%E4%BF%A1/" class="md-nav__link">
      3.6 可见光通信
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4.%20%E7%89%A9%E8%81%94%E7%BD%91%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE/%E8%93%9D%E7%89%99%E5%AE%9E%E9%AA%8C/" class="md-nav__link">
      3.7 蓝牙连接实验
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      第4章 信号处理基础
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第4章 信号处理基础" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        第4章 信号处理基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH1_Signal/S1_%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%8F%91%E9%80%81%E5%92%8C%E6%8E%A5%E6%94%B6/" class="md-nav__link">
      4.1 信号生成、发送和接收
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH1_Signal/S2_%E6%A8%A1%E6%8B%9F%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%95%B0%E5%AD%97%E4%BF%A1%E5%8F%B7%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
      4.2 从模拟到数字
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH1_Signal/S3_%E4%BF%A1%E5%8F%B7%E9%87%87%E6%A0%B7%E4%B8%8E%E9%87%87%E6%A0%B7%E5%AE%9A%E7%90%86/" class="md-nav__link">
      4.3 信号采样与采样定理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH1_Signal/S4_%E4%BF%A1%E5%8F%B7%E9%87%8F%E5%8C%96/" class="md-nav__link">
      4.4 信号量化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH1_Signal/S5_%E6%A1%88%E4%BE%8B%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%BD%95%E9%9F%B3%E3%80%81%E6%94%BE%E9%9F%B3%E7%A8%8B%E5%BA%8F/" class="md-nav__link">
      4.5 案例：声音采集与播放
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      第5章 傅里叶分析
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第5章 傅里叶分析" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        第5章 傅里叶分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH2_Fourier/S1_%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90%E4%B8%80%E6%AE%B5%E5%8E%86%E5%8F%B2/" class="md-nav__link">
      5.1 历史与发展
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH2_Fourier/S2_%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/" class="md-nav__link">
      5.2 傅里叶级数
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH2_Fourier/S3_%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/" class="md-nav__link">
      5.3 傅里叶变换
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH2_Fourier/S4_%E7%A6%BB%E6%95%A3%E5%82%85%E9%87%8C%E5%8F%B6%E5%88%86%E6%9E%90/" class="md-nav__link">
      5.4 离散傅里叶分析
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH2_Fourier/S5_%E7%9F%AD%E6%97%B6%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2/" class="md-nav__link">
      5.5 案例：短时傅里叶与频谱
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      第6章 无线信道
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第6章 无线信道" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        第6章 无线信道
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH3_WirelessChannel/S1_%E4%BF%A1%E9%81%93%E5%AE%9A%E4%B9%89/" class="md-nav__link">
      6.1 定义与概念
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH3_WirelessChannel/S2_%E8%B7%AF%E5%BE%84%E6%8D%9F%E8%80%97%E4%B8%8E%E9%98%B4%E5%BD%B1%E8%A1%B0%E8%90%BD/" class="md-nav__link">
      6.2 路径损耗与阴影衰落
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH3_WirelessChannel/S3_%E5%A4%9A%E5%BE%84%E4%BF%A1%E9%81%93%E6%A8%A1%E5%9E%8B/" class="md-nav__link">
      6.3 多径信道模型
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH3_WirelessChannel/S4_%E6%A1%88%E4%BE%8B/" class="md-nav__link">
      6.4 案例：信道仿真与测量
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      第7章 信号滤波
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第7章 信号滤波" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        第7章 信号滤波
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH4_Filter/S1_%E6%BB%A4%E6%B3%A2%E5%99%A8%E6%A6%82%E5%BF%B5/" class="md-nav__link">
      7.1 滤波定义
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH4_Filter/S2_%E6%BB%A4%E6%B3%A2%E5%99%A8%E8%AE%BE%E8%AE%A1/" class="md-nav__link">
      7.2 滤波器设计
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH4_Filter/S3_%E6%A1%88%E4%BE%8B/" class="md-nav__link">
      7.3 案例：使用滤波器对录音信号降噪
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked>
    
    <label class="md-nav__link" for="nav-10">
      第8章 数据调制和解调
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第8章 数据调制和解调" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        第8章 数据调制和解调
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../S1_%E8%B0%83%E5%88%B6%E8%A7%A3%E8%B0%83%E4%BB%8B%E7%BB%8D/" class="md-nav__link">
      8.1 引言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../S2_%E5%B9%85%E5%BA%A6%E8%B0%83%E5%88%B6/" class="md-nav__link">
      8.2 幅度调制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../S3_%E9%A2%91%E7%8E%87%E8%B0%83%E5%88%B6/" class="md-nav__link">
      8.3 频率调制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../S4_%E7%9B%B8%E4%BD%8D%E8%B0%83%E5%88%B6/" class="md-nav__link">
      8.4 相位调制
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../S5_%E5%9F%BA%E5%B8%A6%E4%BF%A1%E5%8F%B7%E5%92%8C%E8%BD%BD%E6%B3%A2%E4%B8%8A%E5%8F%98%E9%A2%91/" class="md-nav__link">
      8.5 载波上变频
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../S6_%E8%B0%83%E5%88%B6%E6%96%B9%E6%B3%95%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/" class="md-nav__link">
      8.6 调制方法综合应用
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        8.7 简单无线通信系统的实现
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      8.7 简单无线通信系统的实现
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    编码
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    调制
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    解调
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    解码
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      第9章 LoRa原理与实现
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第9章 LoRa原理与实现" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        <span class="md-nav__icon md-icon"></span>
        第9章 LoRa原理与实现
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S1_LoRa%E7%AE%80%E4%BB%8B/" class="md-nav__link">
      9.1 LoRa编码技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S2_LoRa%E9%80%9A%E4%BF%A1%E5%AE%9E%E9%AA%8C/" class="md-nav__link">
      9.2 LoRa编解码与通信实验
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S3_LoRa%E5%86%B2%E7%AA%81%E8%A7%A3%E7%A0%81/" class="md-nav__link">
      9.3 LoRa冲突解码算法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S4_LoRa%E6%B5%8B%E8%AF%95%E5%BA%8A%E6%A6%82%E8%BF%B0%E5%92%8C%E5%8A%9F%E8%83%BD/" class="md-nav__link">
      9.4 LoRa测试床概述和功能
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S5_LoRa%E6%B5%8B%E8%AF%95%E5%BA%8A%E6%8A%80%E6%9C%AF%E5%AE%9E%E7%8E%B0/" class="md-nav__link">
      9.5 LoRa测试床技术实现
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH6_LoRa/S6_LoRa%E8%AE%BE%E5%A4%87%E8%BF%9C%E7%A8%8B%E6%9B%B4%E6%96%B0/" class="md-nav__link">
      9.6 LoRa设备远程更新
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" class="md-nav__link">
      9.7 LoRa Backscatter通信
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" class="md-nav__link">
      9.8 LoRa Backscatter感知
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      第11章 无线测距
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第11章 无线测距" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        <span class="md-nav__icon md-icon"></span>
        第11章 无线测距
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH8_Ranging/S1_%E5%9F%BA%E4%BA%8E%E4%BF%A1%E5%8F%B7%E5%BC%BA%E5%BA%A6%E6%B5%8B%E8%B7%9D/" class="md-nav__link">
      11.1 基于信号强度测距
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH8_Ranging/S2_%E5%9F%BA%E4%BA%8E%E4%BC%A0%E6%92%AD%E6%97%B6%E9%97%B4%E6%B5%8B%E8%B7%9D/" class="md-nav__link">
      11.2 基于传播时间测距
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH8_Ranging/S3_FMCW%E6%B5%8B%E8%B7%9D/" class="md-nav__link">
      11.3 FMCW测距
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      第12章 无线定位
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第12章 无线定位" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        <span class="md-nav__icon md-icon"></span>
        第12章 无线定位
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH9_LocalizationAlgo/S1_TOA%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95/" class="md-nav__link">
      12.1 ToA定位
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH9_LocalizationAlgo/S2_TDOA%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95/" class="md-nav__link">
      12.2 TDoA定位
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH9_LocalizationAlgo/S3_%E5%9F%BA%E4%BA%8E%E5%88%B0%E8%BE%BE%E8%A7%92%E7%9A%84%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95/" class="md-nav__link">
      12.3 基于信号指纹定位
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH9_LocalizationAlgo/S4_%E5%9F%BA%E4%BA%8E%E4%BF%A1%E5%8F%B7%E6%8C%87%E7%BA%B9%E7%9A%84%E5%AE%9A%E4%BD%8D%E7%AE%97%E6%B3%95/" class="md-nav__link">
      12.4 基于到达角定位
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-14" type="checkbox" id="nav-14">
    
    <label class="md-nav__link" for="nav-14">
      第13章 无线追踪
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第13章 无线追踪" data-md-level="1">
      <label class="md-nav__title" for="nav-14">
        <span class="md-nav__icon md-icon"></span>
        第13章 无线追踪
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH10_Tracking/S1_%E5%9F%BA%E4%BA%8E%E5%A4%9A%E6%99%AE%E5%8B%92%E6%95%88%E5%BA%94%E7%9A%84%E8%BF%BD%E8%B8%AA%E6%96%B9%E6%B3%95/" class="md-nav__link">
      13.1 基于多普勒效应追踪
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH10_Tracking/S2_%E5%9F%BA%E4%BA%8EFMCW%E7%9A%84%E8%BF%BD%E8%B8%AA%E6%96%B9%E6%B3%95/" class="md-nav__link">
      13.2 基于FMCW追踪
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH10_Tracking/S3_%E5%9F%BA%E4%BA%8E%E4%BF%A1%E5%8F%B7%E7%9B%B8%E4%BD%8D%E5%8F%98%E5%8C%96%E7%9A%84%E8%BF%BD%E8%B8%AA%E6%96%B9%E6%B3%95/" class="md-nav__link">
      13.3 基于信号相位追踪
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-15" type="checkbox" id="nav-15">
    
    <label class="md-nav__link" for="nav-15">
      第14章 无线感知实例
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="第14章 无线感知实例" data-md-level="1">
      <label class="md-nav__title" for="nav-15">
        <span class="md-nav__icon md-icon"></span>
        第14章 无线感知实例
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S1_%E5%9F%BA%E4%BA%8E%E4%BF%A1%E5%8F%B7%E7%89%B9%E5%BE%81%E7%9A%84%E6%89%8B%E5%8A%BF%E8%AF%86%E5%88%AB/" class="md-nav__link">
      14.1 基于信号特征的手势识别
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S4_%E9%BA%A6%E5%85%8B%E9%A3%8E%E9%98%B5%E5%88%97%E6%84%9F%E7%9F%A5/" class="md-nav__link">
      14.2 基于麦克风阵列的定位方法
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S2_%E5%A3%B0%E9%9F%B3%E8%AE%BE%E5%A4%87%E8%AE%A4%E8%AF%81/%E9%A2%91%E7%8E%87%E9%80%89%E6%8B%A9/" class="md-nav__link">
      14.3 基于信号特征的设备认证
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S3_UWB%E6%84%9F%E7%9F%A5/" class="md-nav__link">
      14.4 UWB设备环境配置
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S6_WIFI%E6%84%9F%E7%9F%A5/" class="md-nav__link">
      14.5 WiFi CSI的获取
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../CH11_Sensing/S5_%E8%93%9D%E7%89%99%E6%84%9F%E7%9F%A5/" class="md-nav__link">
      14.6 蓝牙AoA测量角度的方法
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    编码
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    调制
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    解调
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    解码
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">相对完整的通信系统实现<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>​       本节以脉冲间隔调制为例，在代码层面实现一个简单的无线通信系统。具体来说，该系统包含一个发送方和一个接收方。发送方的输入是一段文本信息，输出一个音频文件，作为调制好的信号。我们通过手机或者电脑播放该音频文件，然后用另一台设备进行接收。接收方的输入是录制后的音频文件，即接收到的信号，输出是一段文本信息。</p>
<p>​       通过下面代码的实现，大家可以动手体验一下实际环境中的信号传输过程。体会
- 实际传输中的基本步骤
- 实际环境给无线通信带来各种各样的问题，在物联网通信的很多前沿研究工作和论文中，实际上很多时候都是处理各种实际场景里面的问题。
比如
  - 如何检测数据从什么时候开始
  - 如何滤除接收信号中的干扰噪声
  - 如何处理扬声器和麦克风的失真
  - 如何处理发送端设备和接收端设备的频移（这在物联网设备尤其是低成本物联网设备上更加普遍和严重）</p>
<h2 id="_2">编码<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>​       我们首先需要把输入的文本信息转换为二进制串，然后才能进行调制。可以按照<span><span class="MathJax_Preview">ASCII</span><script type="math/tex">ASCII</script></span>的编码方式将文本中的每个字符对应到8 bit，按照顺序将它们连接起来。为此我们实现一个名为<code>string2bin</code>的函数：</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span>[ binary ] <span class="p">=</span><span class="w"> </span><span class="nf">string2bin</span><span class="p">(</span> str <span class="p">)</span><span class="w"></span>
<span class="c">%把字符串转换成二进制串</span>
<span class="n">ascii</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">str</span><span class="p">);</span>
<span class="n">L</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">ascii</span><span class="p">);</span>
<span class="n">binary</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="mi">8</span><span class="p">);</span>
<span class="n">for</span> <span class="s">i=1:L</span>
    <span class="n">binary_str</span> <span class="p">=</span> <span class="n">dec2bin</span><span class="p">(</span><span class="n">ascii</span><span class="p">(</span><span class="nb">i</span><span class="p">));</span>
    <span class="n">binary_str_index</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">binary_str</span><span class="p">);</span>
    <span class="n">for</span> <span class="s">j</span> <span class="p">=</span> <span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span>
        <span class="n">if</span> <span class="s">binary_str_index</span> <span class="o">&gt;</span><span class="mi">0</span>
            <span class="n">binary</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">)</span> <span class="p">=</span> <span class="n">str2num</span><span class="p">(</span><span class="n">binary_str</span><span class="p">(</span><span class="n">binary_str_index</span><span class="p">));</span>
        <span class="n">else</span>
            <span class="s">binary(i,j)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">end</span>
        <span class="s">binary_str_index</span> <span class="p">=</span> <span class="n">binary_str_index</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">end</span>
<span class="s">end</span>
<span class="n">binary</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">binary</span><span class="o">&#39;</span><span class="p">,[</span><span class="n">L</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span>
<span class="n">end</span>
</code></pre></div>
<p>​       我们采用声波信号进行通信。采样频率为48 kHz​，由于大多数人听不到17 kHz频率以上的声音，也不会发出超过17 Hz的声音，因此在我们的方法中我们让设备发送18 kHz的声波，这样就可以在发送过程中不干扰其他人，也可以让信号避免被人说话声音干扰。选择脉冲长度为100个采样点，由于采样频率为48 kHz，脉冲的持续时间是<span><span class="MathJax_Preview">100/48000\approx 2.1ms</span><script type="math/tex">100/48000\approx 2.1ms</script></span>。脉冲之间的间隔采样点数与编码的对应规则见下表：</p>
<table>
<thead>
<tr>
<th>脉冲间隔（单位为采样点）</th>
<th>编码</th>
</tr>
</thead>
<tbody>
<tr>
<td>50</td>
<td>00</td>
</tr>
<tr>
<td>100</td>
<td>01</td>
</tr>
<tr>
<td>150</td>
<td>10</td>
</tr>
<tr>
<td>200</td>
<td>11</td>
</tr>
</tbody>
</table>
<h2 id="_3">调制<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<p>​       有了编码规则，我们就可以根据输入文本生成信号了。</p>
<p>​       首先是要产生声波信号，在脉冲间隔调制中，我们需要生成固定频率（18 kHz）固定长度（100个采样点）的脉冲信号：</p>
<div class="highlight"><pre><span></span><code><span class="c">%%</span>
<span class="n">fs</span> <span class="p">=</span> <span class="mi">48000</span><span class="p">;</span>                         <span class="c">%设置采样频率</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">18000</span><span class="p">;</span>                          <span class="c">%指定声音信号频率</span>
<span class="n">time</span> <span class="p">=</span> <span class="mf">0.0025</span><span class="p">;</span>                      <span class="c">%指定生成的信号持续时间</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">:</span><span class="n">time</span><span class="p">;</span>                    <span class="c">%设置每个采样点数据对应的时间</span>
<span class="n">t</span> <span class="p">=</span> <span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">100</span><span class="p">);</span>                       <span class="c">%截取出100个时间上的采样点</span>
<span class="n">impulse</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>            <span class="c">%生成频率为f的正弦信号</span>
</code></pre></div>
<p>​       接下来我们生成用于编码的空白部分：</p>
<div class="highlight"><pre><span></span><code><span class="n">delta</span> <span class="p">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="n">pause0</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">delta</span><span class="p">);</span>      <span class="c">%编码00</span>
<span class="n">pause1</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">delta</span><span class="p">);</span>    <span class="c">%编码01</span>
<span class="n">pause2</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">delta</span><span class="p">);</span>    <span class="c">%编码10</span>
<span class="n">pause3</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">delta</span><span class="p">);</span>    <span class="c">%编码11</span>
</code></pre></div>
<p>​       设置待传输的字符串：</p>
<div class="highlight"><pre><span></span><code><span class="n">str</span> <span class="p">=</span> <span class="s">&#39;Tsinghua University&#39;</span><span class="p">;</span>
</code></pre></div>
<p>​       调用<code>string2bin</code>函数时传入之前设置的待传输字符串，就可以得到待传输的二进制串，将其存储在变量<code>message</code>中：</p>
<div class="highlight"><pre><span></span><code><span class="n">message</span> <span class="p">=</span> <span class="n">string2bin</span><span class="p">(</span> <span class="n">str</span> <span class="p">)</span><span class="o">&#39;</span><span class="p">;</span> <span class="c">%调用函数把字符串转为二进制串</span>
<span class="c">%因为我们设计的编码是每个码元代表2个bit，这里要把二进制串转为4进制串</span>
<span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">m_Length</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="n">message4</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">for</span> <span class="s">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m_Length</span><span class="o">/</span><span class="mi">2</span>
    <span class="c">% 把二进制串中的每两位进行结合，得到四进制串</span>
    <span class="n">message4</span> <span class="p">=</span> <span class="p">[</span><span class="n">message4</span><span class="p">,</span><span class="n">message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="n">message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)];</span>
<span class="n">end</span>
</code></pre></div>
<p>​       生成编码数据：</p>
<div class="highlight"><pre><span></span><code><span class="n">output</span> <span class="p">=</span> <span class="p">[];</span>
<span class="c">% 根据四进制串中的值，将impulse和对应的空白信号添加到输出信号中</span>
<span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">m_Length</span><span class="o">/</span><span class="mi">2</span>
    <span class="n">if</span> <span class="s">message4(i)==0</span>
        <span class="n">output</span> <span class="p">=</span> <span class="p">[</span><span class="n">output</span><span class="p">,</span><span class="n">impulse</span><span class="p">,</span><span class="n">pause0</span><span class="p">];</span>
    <span class="n">elseif</span> <span class="s">message4(i)==1</span>
        <span class="n">output</span> <span class="p">=</span> <span class="p">[</span><span class="n">output</span><span class="p">,</span><span class="n">impulse</span><span class="p">,</span><span class="n">pause1</span><span class="p">];</span>
    <span class="n">elseif</span> <span class="s">message4(i)==2</span>
        <span class="n">output</span> <span class="p">=</span> <span class="p">[</span><span class="n">output</span><span class="p">,</span><span class="n">impulse</span><span class="p">,</span><span class="n">pause2</span><span class="p">];</span>
    <span class="n">else</span>
        <span class="s">output</span> <span class="p">=</span> <span class="p">[</span><span class="n">output</span><span class="p">,</span><span class="n">impulse</span><span class="p">,</span><span class="n">pause3</span><span class="p">];</span>
    <span class="n">end</span>
<span class="s">end</span>
<span class="c">% 在输出信号前加一段空白，避免播放器在信号刚开始的位置出现失真的情况。</span>
<span class="n">output</span> <span class="p">=</span> <span class="p">[</span><span class="n">pause3</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">impulse</span><span class="p">];</span>
<span class="c">% 在figure中画出输出的时域信号</span>
<span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
<span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">500</span> <span class="mi">17500</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">3</span><span class="p">]);</span>
<span class="c">% 将输出信号写入到音频文件中，需要指明文件名、数据、和采样频率。</span>
<span class="n">audiowrite</span><span class="p">(</span><span class="s">&#39;message.wav&#39;</span><span class="p">,</span><span class="n">output</span><span class="p">,</span><span class="n">fs</span><span class="p">);</span>
</code></pre></div>
<p>​       这里涉及到一个有关扬声器播放声音的问题。有的扬声器在刚打开工作时，其中的电路会经历一个冷启动的过程，因此导致此时播放的声音出现失真的现象。我们可以在音频信号的前面加一段空白信号以跳过这一段冷启动过程。</p>
<p>​       最终生成的输出信号时域信号如图所示，横轴代表采样点的序号，纵轴代表幅度：</p>
<p><center>
<img src = "./fig/4.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 编码生成的时域信号</div>
<p></center></p>
<p>​       得到调制过信息的声音文件后，我们将文件存储在一个android 手机上，并使用一个声音播放器打开此文件进行播放。同时，我们使用另一个设备将声波信号录制下来存储到录音文件“r.wav”中。因为我们这里展示的是简单的调制方式，单个声道录到的数据就足够解码，因此录制声波时采用的单声道录制。</p>
<h2 id="_4">解调<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<p>​       以下的解调和解码部分写在<code>decoding.m</code>这个脚本中。用matlab读取录音文件“r.wav”,并将读出的数据在图中展示出来：</p>
<div class="highlight"><pre><span></span><code><span class="c">%% 读取录音文件中的数据</span>
<span class="p">[</span><span class="n">data</span><span class="p">,</span> <span class="n">fs</span><span class="p">]</span> <span class="p">=</span> <span class="n">audioread</span><span class="p">(</span><span class="s">&#39;r.wav&#39;</span><span class="p">);</span>
<span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
<span class="n">hold</span> <span class="s">on</span><span class="p">;</span>
</code></pre></div>
<p><center>
<img src = "./fig/receive_data.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 接收到的声音信号</div>
<p></center></p>
<p>​       从上图中可见，经历了扬声器播放、空气传播、麦克风接收的声波信号，和未经传输的信号之间有一定的区别，对应了传输过程中引入的各种噪声。</p>
<p>​       在进行解调之前，我们先来回顾一下脉冲间隔调制的原理。由于脉冲间隔调制使用的是脉冲之间的间隔长短来编码数据，所以解调的关键在于得到每两个相邻脉冲之间的间隔，从而将其转换为对应的二进制数据。要得到脉冲之间的间隔，就需要获取每个脉冲的起始和结束时间。因为每个脉冲的长度是固定的，所以我们只需要知道脉冲的起始位置即可。</p>
<p>​       怎样找到脉冲的起始位置呢？在这个例子中我们采用能量强度阈值的方法。</p>
<p>​       借助傅里叶变换，我们可以获取一段时域信号中某个频率信号的强度。通过把时域信号进行分段的傅里叶变换，每段信号中18 kHz信号的强度都可以被计算出来。由于我们设计的脉冲长度是100个采样点，当我们把傅里叶变换的窗口长度设置为100时，只有窗口从脉冲起始点开始截取信号的时候，才能使得整个时域窗口中都充满18 kHz的声音信号。若是窗口起始点不在脉冲起始的位置，那么时域窗口中将不可避免地包含到一部分空白信号（没有声音信号，采样值接近0）。根据傅里叶变换的原理，频域上的能量强度是时域上对应频率能量的叠加。所以当窗口对齐脉冲起始位置时，傅里叶变换得到的18 kHz​处的能量是最高的。我们可以记录下每个时域窗口对应的18 kHz​的能量强度，通过寻找极大值得到每个脉冲信号的起始位置。</p>
<p><center>
<img src = "./fig/winding.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 脉冲信号和时域窗口</div>
<p></center></p>
<p>​       接下来我们进行解调操作。首先对信号进行滤波，去除掉环境中的噪音，只保留信号调制所用到的<span><span class="MathJax_Preview">18kHz</span><script type="math/tex">18kHz</script></span>的声音信号：</p>
<div class="highlight"><pre><span></span><code><span class="c">%% 对录音数据进行滤波</span>
<span class="c">%定义一个带通滤波器</span>
<span class="n">hd</span> <span class="p">=</span> <span class="n">design</span><span class="p">(</span><span class="n">fdesign</span><span class="p">.</span><span class="n">bandpass</span><span class="p">(</span><span class="s">&#39;N,F3dB1,F3dB2&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">17500</span><span class="p">,</span><span class="mi">18500</span><span class="p">,</span><span class="n">fs</span><span class="p">),</span><span class="s">&#39;butter&#39;</span><span class="p">);</span>
<span class="c">%用定义好的带通滤波器对data进行滤波</span>
<span class="n">data</span> <span class="p">=</span> <span class="n">filter</span><span class="p">(</span><span class="n">hd</span><span class="p">,</span><span class="n">data</span><span class="p">);</span>
</code></pre></div>
<blockquote>
<p>思考：实际上，在脉冲间隔调制中，滤波这一操作不是必须的，你知道是为什么吗？</p>
</blockquote>
<p>​       接下来我们对录音信号进行滑动窗口的傅里叶变换，得到每一段数据中18 kHz​信号的强度信息：</p>
<div class="highlight"><pre><span></span><code><span class="c">%% 对数据进行带滑动窗口的傅里叶变换。得到每一段数据中18kHz信号的强度信息</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">18000</span><span class="p">;</span>                      <span class="c">%目标频率为18kHz</span>
<span class="p">[</span><span class="n">n</span><span class="p">,</span><span class="o">~</span><span class="p">]</span> <span class="p">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>             <span class="c">%获取数据的长度值</span>
<span class="n">window</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span>                   <span class="c">%设置窗口大小为100个采样点</span>
<span class="c">%定义变量数组impulse_fft，用于存储每个时刻对应的数据段中18kHz信号的强度</span>
<span class="n">impulse_fft</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>   
<span class="n">for</span> <span class="s">i=</span> <span class="s">1:1:n-window</span>
    <span class="c">%对从当前点开始的window长度的数据进行傅里叶变换</span>
    <span class="n">y</span> <span class="p">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">data</span><span class="p">(</span><span class="nb">i</span><span class="p">:</span><span class="nb">i</span><span class="o">+</span><span class="n">window</span><span class="o">-</span><span class="mi">1</span><span class="p">));</span>
    <span class="n">y</span> <span class="p">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
    <span class="c">%得到目标频率傅里叶变换结果中对应的index</span>
    <span class="n">index_impulse</span> <span class="p">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">f</span><span class="o">/</span><span class="n">fs</span><span class="o">*</span><span class="n">window</span><span class="p">);</span>
    <span class="c">%考虑到声音通信过程中的频率偏移，我们取以目标频率为中心的5个频率采样点中最大的一个来代表目标频率的强度</span>
    <span class="n">impulse_fft</span><span class="p">(</span><span class="nb">i</span><span class="p">)=</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">index_impulse</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="n">index_impulse</span><span class="o">+</span><span class="mi">2</span><span class="p">));</span>
<span class="n">end</span>
<span class="s">%</span> <span class="s">在figure中展示每个窗口对应的18kHz信号的强度</span>
<span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">impulse_fft</span><span class="p">);</span>
</code></pre></div>
<p>​       在下图中展示每个时域窗口的信号对应的18 kHz​信号的强度：</p>
<p><center>
<img src = "./fig/impulse_fft_raw.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 每个时域窗口对应的18 kHz信号的强度</div>
<p></center></p>
<p>​       对局部进行放大，我们可以观察到锯齿形的曲线：</p>
<p><center>
<img src = "./fig/impulse_fft_raw_zoom.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 时域上的18kHz信号强度的局部放大</div>
<p></center></p>
<p>​       我们的目的是通过找极大值准确得到每个脉冲信号的起始位置，然而锯齿形的信号的最大值可能不严格出现在信号峰的中间位置。我们需要通过滑动窗口平均来对impulse_fft进行均值滤波，得到一个平滑的曲线。在这里我们设置一个大小为11的窗口：</p>
<div class="highlight"><pre><span></span><code><span class="c">% 滑动平均（均值滤波）</span>
<span class="n">sliding_window</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">impulse_fft_tmp</span> <span class="p">=</span> <span class="n">impulse_fft</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i</span> <span class="p">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">sliding_window</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="n">sliding_window</span>
    <span class="n">impulse_fft_tmp</span><span class="p">(</span><span class="nb">i</span><span class="p">)=</span><span class="n">mean</span><span class="p">(</span><span class="n">impulse_fft</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="n">sliding_window</span><span class="p">:</span><span class="nb">i</span><span class="o">+</span><span class="n">sliding_window</span><span class="p">));</span>
<span class="n">end</span>
<span class="s">impulse_fft</span> <span class="p">=</span> <span class="n">impulse_fft_tmp</span><span class="p">;</span>
<span class="c">% 在figure中展示平滑后的impulse_fft</span>
<span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">impulse_fft</span><span class="p">);</span>
<span class="n">hold</span> <span class="s">on</span><span class="p">;</span>
</code></pre></div>
<p>​       我们可以从下图中看出，均值滤波有效地把锯齿形的信号转化成了相对平滑的信号。对于滑动窗口的大小，可以根据实际需要进行调整。</p>
<p><center>
<img src = "./fig/impulse_fft_sliding_zoom.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 经过滑动平均的18kHz信号强度的局部放大</div>
<p></center></p>
<p>​       由于在实际操作中，我们不能保证经过平滑之后的信号在峰的两侧都是单调的，所以我们用局部最大值来替代极大值来进行判断。通过找到局部最大值得到峰的中间位置，从而得到脉冲信号的起始位置。由于脉冲的长度为100，所以我们再次使用一个长度为100的窗口，这次的窗口是以当前点为窗口的中间，往前后各取半个窗口的长度。当中心点的值是整个窗口中的最大值时，说明左右两侧的点都比中间点的值小，也就是说，当前窗口的中心点是一个峰。为了去除空白数据处的曲线波动对峰值判断的干扰，我们多加了一个对峰的高度的判断，当数据值小于等于<span><span class="MathJax_Preview">0.3</span><script type="math/tex">0.3</script></span>（阈值）时，无论曲线在此处的走势如何，这里都不会是一个峰。</p>
<div class="highlight"><pre><span></span><code><span class="c">% 取出impulse 起始位置（峰的中间位置）</span>
<span class="n">position_impulse</span><span class="p">=[];</span>    <span class="c">%用于存储峰值的index</span>
<span class="n">half_window</span> <span class="p">=</span> <span class="mi">50</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=</span> <span class="s">half_window+1:1:n-half_window</span>
    <span class="c">%进行峰值判断</span>
    <span class="n">if</span> <span class="s">impulse_fft(i)&gt;0.3</span> <span class="o">&amp;&amp;</span> <span class="n">impulse_fft</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span><span class="o">==</span><span class="n">max</span><span class="p">(</span><span class="n">impulse_fft</span><span class="p">(</span><span class="nb">i</span><span class="o">-</span><span class="n">half_window</span><span class="p">:</span><span class="nb">i</span><span class="o">+</span><span class="n">half_window</span><span class="p">))</span>
        <span class="n">position_impulse</span><span class="p">=[</span><span class="n">position_impulse</span><span class="p">,</span><span class="nb">i</span><span class="p">];</span>
    <span class="n">end</span>
<span class="s">end</span>
</code></pre></div>
<p>​       根据我们前面的分析可知，峰值的位置就是脉冲的起始位置。为了验证这个结论，我们把得到的峰值位置在时域信号图中展示出来，并计算相邻两个脉冲之间的间隔：</p>
<div class="highlight"><pre><span></span><code><span class="c">%% 在图中表示出脉冲起始位置并计算相邻两个脉冲之间的间隔</span>
<span class="p">[</span><span class="o">~</span><span class="p">,</span><span class="n">N</span><span class="p">]=</span> <span class="nb">size</span><span class="p">(</span><span class="n">position_impulse</span><span class="p">);</span>
<span class="c">%定义变量delta_impulse用于存储相邻两个脉冲之间的间隔</span>
<span class="n">delta_impulse</span><span class="p">=</span><span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">for</span> <span class="s">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>
    <span class="c">%在18kHz信号的强度图中标出脉冲起始位置</span>
    <span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">([</span><span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">],</span><span class="s">&#39;m&#39;</span><span class="p">);</span>
    <span class="c">%在时域信号上标出脉冲起始位置</span>
    <span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">([</span><span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">),</span><span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)],[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">],</span><span class="s">&#39;m&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
    <span class="c">%计算两个相邻脉冲之间的间隔。-100是减去脉冲信号长度</span>
    <span class="n">delta_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span>  <span class="n">position_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span>
<span class="n">end</span>
</code></pre></div>
<p>​       脉冲起始位置在原始时域声音信号上的展示如下图所示。观察发现，代表着我们计算得到的脉冲起始位置的洋红色线条所切割的位置，并不是真正的脉冲信号起始位置。在洋红色线条之前已经有一段的声音信号存在了。</p>
<p><center>
<img src = "./fig/impulse_position_raw.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 计算得到的脉冲起始在真实时域信号中与脉冲起始不匹配</div>
<p></center></p>
<p>​       然而这些洋红色线条在18kHz​强度的时域图中与峰值很好地一一对应，如下图所示。</p>
<p><center>
<img src = "./fig/impulse_position_fft.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 计算得到的脉冲起始位置和18kHz信号强度峰值整齐对应</div>
<p></center></p>
<p>​       也就是说，18 kHz​信号强度的时域图中的峰值并不是出现在脉冲的起始位置。这个结论我们最初的理论分析是不一致的。为了解释这一现象，我们将真实时域信号和分窗口傅里叶变换得到的18 kHz信号强度时域图画在下图中进行观察。我们发现18 kHz信号强度峰值并没有出现在信号起始处，如下图所示：</p>
<p><center>
<img src = "./fig/raw_and_fft.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 18kHz信号强度峰值并没有出现在信号起始处</div>
<p></center></p>
<p>​       这个现象其实是滤波造成的。如果我们把上图中的原始信号替换成滤波之后的信号，就会发现滤波后的每个脉冲的开头和结尾处的信号比中间的弱。这个滤波器特性导致的现象，再加上多径效应造成的回声现象，使得滑动窗口傅里叶变换得到的最大值并不是出现在脉冲的起始位置。</p>
<p><center>
<img src = "./fig/filter_and_fft.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 18kHz信号强度时域图以及滤波之后的声音信号</div>
<p></center></p>
<p>​       如果我们不对信号进行滤波，而是直接用原始的声音数据进行滑动窗口傅里叶变换，得到的结果如下图所示。我们可以看到18 kHz信号强度的峰值确实出现在了声音信号的起始位置，但由于没有进行滤波，原始信号中存在的频率更杂乱，使得我们得到的18 kHz信号强度曲线也更加波折。</p>
<p><center>
<img src = "./fig/raw_and_fft2.png" width=600px>
</center>
<center></p>
<div style="color:orange; border-bottom: 1px solid #d9d9d9; display: inline-block;color: #999;padding: 2px;">图. 18kHz信号强度峰值出现在了信号起始处</div>
<p></center></p>
<p>​       尽管用滤波前的原始数据和滤波后的数据进行滑动窗口傅里叶变换，得到的峰值位置不一致，事实上，这两种方式都可以成功解码出数据。这是因为我们解码数据依靠的是相邻两个脉冲信号之间的间隔，就算识别出来的脉冲信号的绝对位置有偏差，只要每个脉冲信号位置都偏差大致相似的采样点数，相邻两个脉冲信号之间的间隔就是大致不变的。当我们设计编码时，不同码元使用的间隔之间差异足够大，就可以保证解码的准确性。</p>
<h2 id="_5">解码<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>​       接下来我们使用相邻脉冲之间的间隔进行解码。根据我们设计编码时定义的对应规则把不同长度的间隔映射为不同的编码数据。另外，由于噪声等的影响，我们得到的间隔长度不会严格等于设计值。这时就需要我们在解码时加入一定的鲁棒性。在这个实验中，我们认为只要实际间隔值和设计值之间的误差小于10，就解码出对应的数据，否则解码失败。误差的阈值可以根据信道、信号等的实际情况进行设置。</p>
<div class="highlight"><pre><span></span><code><span class="c">%% 解码</span>
<span class="c">%由于每个码元对应2bit，所以先把间隔对应到4进制数</span>
<span class="n">decode_message4</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">if</span> <span class="s">delta_impulse(i)</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">&gt;-</span><span class="mi">10</span> <span class="o">&amp;&amp;</span><span class="n">delta_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">50</span> <span class="o">&lt;</span><span class="mi">10</span>
        <span class="n">decode_message4</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">delta_impulse(i)</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">&gt;-</span><span class="mi">10</span> <span class="o">&amp;&amp;</span><span class="n">delta_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">100</span> <span class="o">&lt;</span><span class="mi">10</span>
        <span class="n">decode_message4</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">delta_impulse(i)</span> <span class="o">-</span> <span class="mi">150</span> <span class="o">&gt;-</span><span class="mi">10</span> <span class="o">&amp;&amp;</span><span class="n">delta_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">150</span> <span class="o">&lt;</span><span class="mi">10</span>
        <span class="n">decode_message4</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">delta_impulse(i)</span> <span class="o">-</span> <span class="mi">200</span> <span class="o">&gt;-</span><span class="mi">10</span> <span class="o">&amp;&amp;</span><span class="n">delta_impulse</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">200</span> <span class="o">&lt;</span><span class="mi">10</span>
        <span class="n">decode_message4</span><span class="p">(</span><span class="nb">i</span><span class="p">)</span> <span class="p">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">end</span>
<span class="s">end</span>
<span class="c">% 把四进制转化为二进制</span>
<span class="n">decode_message</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">if</span> <span class="s">decode_message4(i)</span> <span class="p">==</span> <span class="mi">0</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">decode_message4(i)</span> <span class="p">==</span> <span class="mi">1</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">decode_message4(i)</span> <span class="p">==</span> <span class="mi">2</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)=</span><span class="mi">0</span><span class="p">;</span>
    <span class="n">elseif</span> <span class="s">decode_message4(i)</span> <span class="p">==</span> <span class="mi">3</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">decode_message</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="mi">2</span><span class="p">)=</span><span class="mi">1</span><span class="p">;</span>
    <span class="n">end</span>
<span class="s">end</span>
</code></pre></div>
<p>​       现在我们解码出了声音信号中编码的二进制串，要将其转化为可解读的信息还需要将二进制串变成字符串。我们实现一个与<code>string2bin</code>函数对应的<code>bin2string</code>函数来实现这个功能：</p>
<div class="highlight"><pre><span></span><code><span class="k">function</span><span class="w"> </span>[ str ] <span class="p">=</span><span class="w"> </span><span class="nf">bin2string</span><span class="p">(</span> binary <span class="p">)</span><span class="w"></span>
<span class="c">% 把二进制串转化为字符串</span>
<span class="n">L</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">binary</span><span class="p">);</span>
<span class="n">str</span> <span class="p">=</span> <span class="p">[];</span>
<span class="n">binary</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">binary</span><span class="o">&#39;</span><span class="p">,[</span><span class="mi">8</span><span class="p">,</span><span class="n">L</span><span class="o">/</span><span class="mi">8</span><span class="p">]);</span>
<span class="n">binary</span> <span class="p">=</span> <span class="n">binary</span><span class="o">&#39;</span><span class="p">;</span>
<span class="n">for</span> <span class="s">i=1:L/8</span>
    <span class="n">s</span><span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">for</span> <span class="s">j</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">8</span>
        <span class="n">s</span> <span class="p">=</span> <span class="n">s</span><span class="o">+</span><span class="mi">2</span>^<span class="p">(</span><span class="mi">8</span><span class="o">-</span><span class="nb">j</span><span class="p">)</span><span class="o">*</span><span class="n">binary</span><span class="p">(</span><span class="nb">i</span><span class="p">,</span><span class="nb">j</span><span class="p">);</span>
    <span class="n">end</span>
    <span class="s">str</span> <span class="p">=</span> <span class="p">[</span><span class="n">str</span><span class="p">,</span><span class="n">char</span><span class="p">(</span><span class="n">s</span><span class="p">)];</span>
<span class="n">end</span>
<span class="s">end</span>
</code></pre></div>
<p>​       最后，调用<code>bin2string</code>函数：</p>
<p><div class="highlight"><pre><span></span><code><span class="c">%把二进制数据根据ascii码值解出对应的字符串</span>
<span class="n">str</span> <span class="p">=</span> <span class="n">bin2string</span><span class="p">(</span><span class="n">decode_message</span><span class="p">)</span>
</code></pre></div>
​       运行整个脚本可以得到可以解码的数据串:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;</span> <span class="n">decoding</span>
<span class="n">str</span><span class="p">=</span>
    <span class="s">&#39;Tsinghua University&#39;</span>
<span class="o">&gt;&gt;</span>
</code></pre></div>
<p>​       至此，一个简单的无线传输系统就完成了。</p>
<blockquote>
<p>思考 
1. 能量强度阈值的方法在别的调制方法上是否适用？如果环境中存在较强的干扰，使得能量较强的地方很可能是噪声，应该如何检测信号的起始位置？
2. 在脉冲间隔调制中，如果有一个脉冲因噪声没能被检测到，则会导致之后所有的脉冲都错位一个，因此解出的二进制串从这一位后全都没有对齐。如何减少这种情况带来的影响？
3. 这里用的是脉冲调制的方法，能不能将调制方法换成前面学过的BPSK，QPSK，8PSK，OQPSK，64QAM，OFDM等？</p>
</blockquote>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../S6_%E8%B0%83%E5%88%B6%E6%96%B9%E6%B3%95%E7%BB%BC%E5%90%88%E5%BA%94%E7%94%A8/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  上一页
                </span>
                8.6 调制方法综合应用
              </div>
            </div>
          </a>
        
        
          <a href="../../CH6_LoRa/S1_LoRa%E7%AE%80%E4%BB%8B/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  下一页
                </span>
                9.1 LoRa编码技术
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.6a3d08fc.min.js"></script>
      <script src="../../assets/javascripts/bundle.71201edf.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>