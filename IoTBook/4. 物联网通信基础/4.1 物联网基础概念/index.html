



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="介绍物联网基础概念">
      
      
      
        <meta name="author" content="WiSys Lob">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../assets/images/logo.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-ponylang-0.2.5">
    
    
      
        <title>5.1 物联网基础概念 - IoT Book</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.dfc6cb0c.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../../assets/javascripts/modernizr.6586f7cd.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../../#_1" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
          <a href="../../.." title="IoT Book" class="md-header-nav__button md-logo">
          
            <img src="../../../images/cbd47-7mlgx-001.ico" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                IoT Book
              </span>
              <span class="md-header-nav__topic">
                5.1 物联网基础概念
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../../images/cbd47-7mlgx-001.ico" width="48" height="48">
      
    </span>
    IoT Book
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../1. 前言/物联网导论/" title="一. 前言" class="md-nav__link">
      一. 前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../2. 物联网简介/物联网简介/" title="二. 物联网简介" class="md-nav__link">
      二. 物联网简介
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      三. 开发环境
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        三. 开发环境
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../平台搭建/android开发基础/" title="3.1 Android 环境" class="md-nav__link">
      3.1 Android 环境
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../平台搭建/matlab基础/" title="3.2 MATLAB 环境" class="md-nav__link">
      3.2 MATLAB 环境
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      四. 物联网网络协议
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        四. 物联网网络协议
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. 物联网通信协议/物联网连接技术/" title="4.1 物联网连接技术" class="md-nav__link">
      4.1 物联网连接技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. 物联网通信协议/蓝牙实验/" title="4.2 蓝牙连接实验" class="md-nav__link">
      4.2 蓝牙连接实验
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../3. 物联网通信协议/LoRa编码和通信实验/" title="4.3 LoRa编码和通信实验" class="md-nav__link">
      4.3 LoRa编码和通信实验
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      五. 物联网通信基础
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        五. 物联网通信基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        5.1 物联网基础概念
      </label>
    
    <a href="./" title="5.1 物联网基础概念" class="md-nav__link md-nav__link--active">
      5.1 物联网基础概念
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        
          <li class="md-nav__item">
    <a href="#1" title="1. 采样和量化" class="md-nav__link">
    1. 采样和量化
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#11" title="1.1 声波的生成、发送和接收" class="md-nav__link">
    1.1 声波的生成、发送和接收
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#12" title="1.2 模拟信号到数字信号" class="md-nav__link">
    1.2 模拟信号到数字信号
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#13" title="1.3 量化" class="md-nav__link">
    1.3 量化
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#2" title="2. 傅里叶分析" class="md-nav__link">
    2. 傅里叶分析
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#21" title="2.1 傅里叶级数" class="md-nav__link">
    2.1 傅里叶级数
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#22" title="2.2 傅里叶变换" class="md-nav__link">
    2.2 傅里叶变换
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#23" title="2.3 离散傅里叶变换" class="md-nav__link">
    2.3 离散傅里叶变换
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#24-fft" title="2.4 快速傅里叶变换 (FFT)" class="md-nav__link">
    2.4 快速傅里叶变换 (FFT)
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#3" title="3. 信道" class="md-nav__link">
    3. 信道
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#31" title="3.1 信道状态信息" class="md-nav__link">
    3.1 信道状态信息
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#32" title="3.2 信道冲击响应" class="md-nav__link">
    3.2 信道冲击响应
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#33" title="3.3 信噪比" class="md-nav__link">
    3.3 信噪比
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#34" title="3.4 多径效应" class="md-nav__link">
    3.4 多径效应
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#35" title="3.5 信号衰落" class="md-nav__link">
    3.5 信号衰落
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#4" title="4. 滤波" class="md-nav__link">
    4. 滤波
  </a>
  
</li>
        
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../4.2 调制解调方法及其声音实现/" title="5.2 调制解调方法" class="md-nav__link">
      5.2 调制解调方法
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      六. 物联网网络构建技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        六. 物联网网络构建技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="6.1 低功耗物联网" class="md-nav__link">
      6.1 低功耗物联网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="6.2 多跳自组织网" class="md-nav__link">
      6.2 多跳自组织网
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="6.3 网络冲突处理" class="md-nav__link">
      6.3 网络冲突处理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="6.4 跨协议识别与通信" class="md-nav__link">
      6.4 跨协议识别与通信
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      七. 物联网定位与追踪
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        七. 物联网定位与追踪
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="7.1 无线测距" class="md-nav__link">
      7.1 无线测距
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="7.2 定位技术" class="md-nav__link">
      7.2 定位技术
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="7.3 追踪技术" class="md-nav__link">
      7.3 追踪技术
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      八. 物联网感知技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        八. 物联网感知技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="8.1 传感器感知" class="md-nav__link">
      8.1 传感器感知
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="8.2 行为识别" class="md-nav__link">
      8.2 行为识别
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="8.3 身份认证" class="md-nav__link">
      8.3 身份认证
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      九. 物联网综合应用平台
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        九. 物联网综合应用平台
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../5.物联网感知/定位感知实验/" title="9.1 定位感知" class="md-nav__link">
      9.1 定位感知
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="9.2 阿里云平台" class="md-nav__link">
      9.2 阿里云平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="9.3 LoRa测试床" class="md-nav__link">
      9.3 LoRa测试床
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../404/" title="9.4 物联网开发" class="md-nav__link">
      9.4 物联网开发
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        
          <li class="md-nav__item">
    <a href="#1" title="1. 采样和量化" class="md-nav__link">
    1. 采样和量化
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#11" title="1.1 声波的生成、发送和接收" class="md-nav__link">
    1.1 声波的生成、发送和接收
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#12" title="1.2 模拟信号到数字信号" class="md-nav__link">
    1.2 模拟信号到数字信号
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#13" title="1.3 量化" class="md-nav__link">
    1.3 量化
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#2" title="2. 傅里叶分析" class="md-nav__link">
    2. 傅里叶分析
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#21" title="2.1 傅里叶级数" class="md-nav__link">
    2.1 傅里叶级数
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#22" title="2.2 傅里叶变换" class="md-nav__link">
    2.2 傅里叶变换
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#23" title="2.3 离散傅里叶变换" class="md-nav__link">
    2.3 离散傅里叶变换
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#24-fft" title="2.4 快速傅里叶变换 (FFT)" class="md-nav__link">
    2.4 快速傅里叶变换 (FFT)
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#3" title="3. 信道" class="md-nav__link">
    3. 信道
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          
            <li class="md-nav__item">
    <a href="#31" title="3.1 信道状态信息" class="md-nav__link">
    3.1 信道状态信息
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#32" title="3.2 信道冲击响应" class="md-nav__link">
    3.2 信道冲击响应
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#33" title="3.3 信噪比" class="md-nav__link">
    3.3 信噪比
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#34" title="3.4 多径效应" class="md-nav__link">
    3.4 多径效应
  </a>
  
</li>
          
        
          
            <li class="md-nav__item">
    <a href="#35" title="3.5 信号衰落" class="md-nav__link">
    3.5 信号衰落
  </a>
  
</li>
          
        
      </ul>
    </nav>
  
</li>
        
      
        
          <li class="md-nav__item">
    <a href="#4" title="4. 滤波" class="md-nav__link">
    4. 滤波
  </a>
  
</li>
        
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">物联网基础概念<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. 采样和量化<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>为了介绍清楚无线传输的基础以及在上面发展出来的各种技术，我们先来介绍无线通信的基本原理。无线通信的基本思想就是利用无线电磁波或者无线信号来调制和传输信息。比如最简单的场景中，我们可以产生一个固定频率的无线信号，通过有信号来代表1，没有信号来代表0，来传输信号。由于产生和控制无线电磁型号需要比较复杂的过程，在几年前我在计划该课程的时候一直苦恼怎么让大家很直观的理解其中的技术，最好还能够实际动手试试。现在市面上有能够让我们进行信号处理的设备，但是我觉得还可以做得更直接更好，利用我们的智能手机就能完成这一系列工作。这一个课程中主要利用声波信号来模拟无线信号，声波信号可以很方便的产生，利用普通的智能手机就能够产生、发射和接收声波信号，同时声波信号也易于处理，很好的可视化，同时声波信号的处理和大部分无线信号的处理过程都比较类似，有利于我们理解无线处理的过程。本课程后面的材料中如果没有特殊声明，都讲会使用声波信号来模拟物联网连接过程中的各种技术，请同学们也自己动手来多尝试一下。</p>
<p>在介绍声波信号的处理之前，我们先来理解一下声波信号的基本特征。一般来说，人可以听到的声波范围大概为20Hz到20KHz中间，因此现在大部分手机声音采样率为44100，对应到能够处理的最大声音频率为22KHz左右。超过20KHz的声波我们经常叫做超声波。</p>
<h3 id="11">1.1 声波的生成、发送和接收<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>这一部分对应了无线数据发送的时候的生成、发送和接收。在无线数据发送的过程中，这里每一部分都对应了很多的操作。我们先介绍声波的一些基本知识，然后通过声波的基本知识介绍数据发送和接收的过程。</p>
<p>对于一个最简单的声波信号，可以为一个简单的正弦信号，下图展示的一个频率为1KHz的正弦声波信号，大家可以将这段声音播放出来看看。</p>
<p><img alt="" src="../res/基础概念/plot_sound.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 1KHz正弦声波信号信号</div>
</center></p>
<p>为了产生这段声音，我们只需要在Matlab执行如下的操作并将文件保存下来就可以。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Fs</span> <span class="p">=</span> <span class="mi">44100</span><span class="p">;</span>                             <span class="c">% 采样频率</span>
<span class="n">T</span> <span class="p">=</span> <span class="mi">4</span><span class="p">;</span>                                  <span class="c">% 时间长度</span>
<span class="n">n</span> <span class="p">=</span> <span class="n">Fs</span><span class="o">*</span><span class="n">T</span><span class="p">;</span>                               <span class="c">% 采样点数</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">1000</span><span class="p">;</span>                               <span class="c">% 声音频率</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">T</span><span class="o">*</span><span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>    <span class="c">% 产生声音</span>
<span class="n">sound</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">Fs</span><span class="p">)</span>                             <span class="c">% 播放声音</span>
<span class="n">audiowrite</span><span class="p">(</span><span class="s">&#39;sound.wav&#39;</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">Fs</span><span class="p">);</span>           <span class="c">% 保存声音</span>
</pre></div>
</td></tr></table>

<p>声音是一种机械波，有物体的震动引起了空气的震动，从而能够传播声音。因此出现了超声波洗龙虾、超声波洗牙。</p>
<p>关于Matlab的主要语法，有过任意编程语言经验的人应该都不会感觉到复杂，请大家自行学习。</p>
<p>日常生活中我们能看到的信号大部分都是模拟信号，我们能看到的风雨雷电，我们听到的声音，看到的图片等，要将这些信息存入到电脑中间，需要经过一系列的处理，其中有几个重要的步骤就是采样和量化。无线通信是无线电磁信号为基础的。我们在这一章节中为了方便理解，针对声音信号来进行研究。</p>
<h3 id="12">1.2 模拟信号到数字信号<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>这是信号处理中的关键一步，因为网络通信尤其是无线通信的时候，利用的都是物理信号（如电磁信号），因此通信过程中的重要一步就是将模拟信号转成数字信号。</p>
<p><img alt="通信过程" src="../res/基础概念/p1.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 通信过程</div>
</center></p>
<p>如果真实存在着一个1KHz的声波信号，我们需要接收和处理这个信号的话，先要对信号进行采样和量化，这实际上也是所有计算机处理数据和信号的基础。计算机中将所有模拟信号转化为数字信号是通过采样和量化来实现的。具体来说，通过将模拟信号转化为电信号（通常为电压信号），然后通过将电压量化转成数字信号。在声音信号的处理中，我们首先依赖的是麦克风。麦克风能够将模拟的声音信号转化为电压信号，简单来说，麦克风上有一个可以随着声音振动而振动的薄膜，薄膜振动引起了产生电压的不断变化，因此电压的变化就代表了声音信号的变化。</p>
<p><img alt="麦克风原理" src="../res/基础概念/p2.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 麦克风原理</div>
</center></p>
<p>不过大家要注意的是，这个时候电压在时间和大小上依然是连续的，也就是说任意的电压值都是有可能的，很显然，这样大数据在电脑上是无法保存的，保存的大小是无穷大。为了保存这样的数据，我们先要对数据进行处理。第一个处理就是连续的信号转化为离散的信号。这一步是通过采样来实现的。采样是指计算机设备定时的对信号电压进行采集，采样解决了连续信号到离散信号的问题，可是采样后的电压值仍然没有办法直接保存，因为电压值在可能的取值范围内是连续的，为了解决这个问题，就需要量化。量化简单的来说就是将无限的连续的电压取值转化为有限的离散的电压取值，这样采样后的结果就能够保存。我们平时说的模拟/数字转换器（Analog to Digital Converter，即ADC，与之对应的是数/模转换器,即DAC）其实也就是干的这样的事情。</p>
<p>具体这个事情是怎么来实现的呢，我们首先通过简单的仿真实验来进行情况说明，然后我们再通过实际的信号让大家体会这一过程。假设存在一个正弦的声音信号，频率为5Hz，理想情况下这个信号是一个正弦波，这个信号在matlab下可以如下产生和画图出来。注意，matlab下产生的已经是离散的信号了。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 信号的产生过程</span>
<span class="c">%% 产生一个频率为1000、时长为1s的信号；</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">200</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span> <span class="c">% 1s内2000个采样点</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c">% 频率f=1000</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p><img alt="信号时域图" src="../res/基础概念/p3.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 信号时域图</div>
</center></p>
<p>注意这里面有几个小的问题，当我们将信号频率稍微做一些修改好，画出来的图将变成下面这个样子。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 信号的产生过程</span>
<span class="c">%% 产生一个频率为100、时长为1s的信号；</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">200</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span> <span class="c">% 1s内150个采样点</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">% 频率f=1000</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p><img alt="采样率不足" src="../res/基础概念/p4.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 采样率不足</div>
</center></p>
<p>注意这个图已经完全不是我们想象中的正弦图像了，大家想想看看这个是什么原因。</p>
<p>这里面有几个很有趣的问题，是不是连续的信号就无法用离散的信号表示出来，连续的信号是不是就得用无穷多的离散信号来表达？这里牵涉到了信号采样中的一个重要问题，我们将这个问题更加具体化，假设信号中的最大频率为f，那么应该以多大的采样频率对信号进行采样合理呢，显然不可能无限大的采样频率，这样在计算机上无法处理，实际上也非常不经济。这个问题也就变为信号的频率为f，那么最少的采样频率为多少。</p>
<p>奈奎斯特采样定律告诉我们，对于这样的情形，需要的采样频率为2*f。采样过程所应遵循的规律，又称取样定理、抽样定理。采样定理说明采样频率与信号频谱之间的关系，是连续信号的基本依据。</p>
<p>我们来看一个更加有意思的例子，如果信号的采样频率设置得不对会怎么样？</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 信号的产生过程</span>
<span class="c">%% 信号的产生过程</span>
<span class="c">%% 产生一个频率为100、时长为1s的信号；</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">10000</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span> <span class="c">% 1s内10000个采样点</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">401</span><span class="p">;</span> <span class="c">% 频率f=1000</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>这个例子中，信号是400Hz的，理论上来说，信号是如下这个样子的：</p>
<p><img alt="400Hz信号" src="../res/基础概念/p5.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 400Hz信号</div>
</center></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 信号的产生过程</span>
<span class="c">%% 产生一个频率为100、时长为1s的信号；</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="mi">402</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span> <span class="c">% 1s内2000个采样点</span>
<span class="n">f</span> <span class="p">=</span> <span class="mi">401</span><span class="p">;</span> <span class="c">% 频率f=1000</span>
<span class="n">y</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="n">f</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>大家可以先来想象一下这个采样出来的结果会是怎么样的。</p>
<p><img alt="低采样频率" src="../res/基础概念/p6.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 低采样频率</div>
</center></p>
<p><strong>思考：</strong></p>
<ol>
<li>为什么会出现这样的结果。</li>
<li>如果频率为f，采样频率为fs，那么混叠后的频率将会是多少，这样会对通信产生什么影响。</li>
<li>用于演示混叠现象的经典例子之一是所谓的“车轮效应”。在影片里当马车越走越快时，马车车轮似乎越走越慢，然后甚至朝反方向运转。为什么？</li>
</ol>
<h3 id="13">1.3 量化<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<p>在数字信号处理领域，量化指将信号的连续取值（或者大量可能的离散取值）近似为有限多个（或较少的）离散值的过程。量化主要应用于从连续信号到数字信号的转换中。连续信号经过采样成为离散信号，离散信号经过量化即成为数字信号。注意离散信号通常情况下并不需要经过量化的过程，但可能在值域上并不离散，还是需要经过量化的过程 。信号的采样和量化通常都是由ADC实现的。</p>
<p>例如8位的ADC可以将标称输入电压范围内的模拟电压信号转换为8位的数字信号。</p>
<p><strong>思考：</strong> 多少位不同的电压值？</p>
<p><img alt="量化效果图" src="../res/基础概念/p7.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 量化效果图</div>
</center></p>
<p><img alt="量化效果" src="../res/基础概念/p8.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 量化效果</div>
</center></p>
<blockquote>
<p>The simplest way to quantize a signal is to choose the digital amplitude value closest to the original analog amplitude. This example shows the original analog signal (green), the quantized signal (black dots), the signal reconstructed from the quantized signal (yellow) and the difference between the original signal and the reconstructed signal (red). The difference between the original signal and the reconstructed signal is the quantization error and, in this simple quantization scheme, is a deterministic function of the input signal.</p>
</blockquote>
<p>为了进一步说明这种四舍五入方法，这里以3 位(3 bit)的二进制数码进行量化的过程为例，如图4-9所示。</p>
<p><img alt="图4-9. 示意图" src="../res/基础概念/p9.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图4-9. 示意图</div>
</center></p>
<p>上图中，输入信号是一个模拟信号，采样点为A～L，幅值范围为0～9，采样值、量化和编码的结果如表4-3所示。</p>
<p><img alt="表4-3 采样值、 量化和编码的结果" src="../res/基础概念/p10.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">表4-3. 采样值、 量化和编码的结果</div>
</center></p>
<blockquote>
<p>ref: <a href="https://baijiahao.baidu.com/s?id=1614627981206121506&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1614627981206121506&amp;wfr=spider&amp;for=pc</a></p>
</blockquote>
<p>可见量化的过程中，输出的信号和原信号是有一定的区别的，这个区别就是量化噪声。我们通常说的高保真，其中有一个重要步骤采取足够多的量化位数，保证量化噪声足够小，量化出来的信号足够接近原始信号，当然其中带来的代价就是存储和处理的开销变大。大家可以去网易音乐上看看高保真音乐的，他后面以后一个码率，这一个码率跟量化是直接相关的。思考：大家想想那个码率都跟什么因素相关。</p>
<p>按照量化级的划分方式分，有均匀量化和非均匀量化。</p>
<p><strong>思考：</strong> 为什么有这两种量化的方式？</p>
<ul>
<li>
<p>均匀量化：ADC输入动态范围被均匀地划分为<span><span class="MathJax_Preview">2^n</span><script type="math/tex">2^n</script></span>份。</p>
</li>
<li>
<p>非均匀量化：ADC输入动态范围的划分不均匀，一般用类似指数的曲线进行量化。</p>
</li>
</ul>
<p>非均匀量化是针对均匀量化提出的，因为一般的语音信号中，绝大部分是小幅度的信号，且人耳听觉遵循指数规律。为了保证关心的信号能够被更精确的还原，我们应该将更多的bit用于表示小信号。</p>
<p><strong>思考</strong>：</p>
<p>假设要将最大频率为8KHz的唱歌的信号转成数字信号，量化bit为8bit，则产生的信号码率至少是多少？1min的信号大小是多少？</p>
<p>到了这里，我们来看一个真实的采样和量化的例子，这也是我们整个数据处理实验的开始。这个实验在手机上就能实现，我们来看看手机上如何进行声音的采样和量化。</p>
<p>在做实验之前，你需要准备好一个手机（安卓和苹果手机都可以），并配置好基本的开发环境，如果你还不太熟悉，参见平台搭建章节。</p>
<p><img alt="img" src="../res/基础概念/p11.png" /></p>
<p>安装好了之后，可以启动第一个声音记录的小程序。仔细看这个小程序，跟大家学习过的网络传输的过程是类似的，前面有一个ADC不断的将声音信号转化成为数字信号，这个数字信号是存储在一个buffer里面的，需要我们讲buffer中的数据不断的读取出来然后保存成声音信号。类似于网络中的数据处理，网卡有一个很重要的功能就是将物理信号转化为数字信号，然后也是需要我们将网络收到的数据从buffer中读取出来。事实上这一个例子也展示了大多数需要用到ADC转化的功能，数据被转换并且保存在一个buffer中，然后对buffer中的数据进行处理。当然进一步来看的话，这个buffer中的数据如何处理也是有不同的手段的，有一些是需要轮询，不断的取看buffer中是否有数据，有一些是基于中断，一旦有数据就会产生一个中断通知进行数据处理，这两种处理方法都可以实现非阻塞模式，即用户无需在这个地方等待buffer内容。还有一种是阻塞模式，用户需要等待buffer内容，当buffer中有数据时才能够继续往下处理。几种模式各有优缺点，这也是数据处理中，尤其是通信和与硬件打交道的数据处理中经常要面临的问题。如果数据处理不及时，数据就会被覆盖导致丢失，这个问题在网络传输中也会遇到。</p>
<p>这里面通过这一个小的程序我们想介绍几个概念，这也是平时大家在网络学习的过程中容易忽视的概念，因为网络学习中我们很难有机会从最底层开始接触到基础的信号处理。在启动录音的过程中，需要设置几个参数，第一个就是采样率，目前设置的是44100Hz，基本能够将人能听到的声音录下来。一个是量化的bit位数，这里设置的是16位，即每一个采样点用16bit来量化。另外一个是声道数量，目前选择的是双声道，即有两路数据。声音编码的格式采用的是PCM格式，这也是一种最基础的声音编码方法，与我们常见的mp3等格式不同，那些格式需要将声音文件进行进一步的编码。这个数据文件也是我们后面会要用到的数据的基础格式。</p>
<p><strong>思考：</strong> 那么2.4GHz信号是否需要4.8GHz的采样频率，也就是意味着1s之内有4.8GHz的数据？</p>
<h2 id="2">2. 傅里叶分析<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p>前面的研究我们可以看出，正弦信号是具备很好的属性，我们都很熟悉，也很好处理的。可是实际中有一个问题，不是每一个信号都是正弦信号，那如何处理这些信号呢。研究中我们有一个方法，可以把一个未知的问题转化为已知的问题，那么一个很自然的想法就是，能不能将一个未知的不好处理的信号转化为已知的好处理的信号。傅里叶分析就是实现这种转换的一个有力工具！傅里叶分析的最基本的作用就是建立信号在时域和频域之间的转换关系，从而一些在时域上难以解决的问题，可以变换到频域进行分析，反之亦然。
<!-- 那么傅里叶变换是怎么得到的呢。我们先不看这么复杂的过程，先来看一个简单的例子。 --></p>
<h3 id="21">2.1 傅里叶级数<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<p>傅立叶级数源于一个对周期函数进行分解的猜想：十七世纪中叶，拉格朗日等数学家发现，某些周期函数可以由三角函数的和来表示。如下面例子所示，对于一个周期为<span><span class="MathJax_Preview">2\pi</span><script type="math/tex">2\pi</script></span>的锯齿形波，通过不断叠加具有不同的周期的三角函数，我们可以使叠加结果逐渐逼近原本的锯齿形波。我们使用MATLAB仿真来更加直观地理解这一过程：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 原始信号：周期为2pi的锯齿形波</span>
<span class="n">fs</span> <span class="p">=</span> <span class="mf">1e3</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">:</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="o">-</span><span class="nb">pi</span> <span class="o">+</span> <span class="nb">mod</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">);</span>
<span class="n">figure</span><span class="p">;</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p><img alt="MATLAB产生周期2\pi\pi的锯齿波" src="../res/基础概念/Fourier/锯齿波.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. MATLAB产生周期2pi的锯齿波</div>
</center>
<!-- <center>图. MATLAB产生周期2pi的锯齿波</center> --></p>
<!-- 接下来，我们使用三角函数对生成的这个锯齿波进行拟合。锯齿波的最小周期为$2\pi$，因此我们首先使用具有相同最小周期的正弦波$\sin(x)$，观察其对锯齿波的拟合情况： -->

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 使用最小周期为2pi的基础正弦波sin(x)拟合锯齿波</span>
<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">on</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">],[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;blue&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.6</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
    <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">3.3</span> <span class="mf">3.3</span><span class="p">]);</span>
    <span class="n">box</span> <span class="n">on</span>
</pre></div>
</td></tr></table>

<p><img alt="一阶拟合结果" src="../res/基础概念/Fourier/一阶拟合.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 一阶拟合结果</div>
</center>
<!-- <center>图. 一阶拟合结果</center> --></p>
<!-- $\sin(x)$与锯齿波周期完全一致 ($\sin(x)$的系数$a=-2$，三角函数的系数将在后文中说明，此处暂不讨论)。比较$a\sin(x)$和锯齿波$y(x)$的大小，发现在$0$到$\pi$的区间内，$a\sin(x)-y(x)$先正后负，且在之后的每一段长度为$\pi$的区间中，$a\sin(x)$和$y(x)$都满足这一规律。因此，我们在$a\sin(x)$的基础上叠加一个周期为$\pi$且输出值先负后正的正弦信号$\sin(2x)$，用于补偿一阶拟合与锯齿波的差异： -->

<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 叠加最小周期为pi的基础正弦波sin(2x)做二阶拟合</span>
<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">on</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">],[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;blue&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.6</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
    <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">3.3</span> <span class="mf">3.3</span><span class="p">]);</span>
    <span class="n">box</span> <span class="n">on</span>
</pre></div>
</td></tr></table>

<p><img alt="二阶拟合结果" src="../res/基础概念/Fourier/二阶拟合.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 二阶拟合结果</div>
</center>
<!-- <center>图. 二阶拟合结果</center> --></p>
<p>继续叠加与锯齿波具有相同周期的三角函数 (即<span><span class="MathJax_Preview">\sin(nx)</span><script type="math/tex">\sin(nx)</script></span>，其中<span><span class="MathJax_Preview">n\in \mathbb{R}</span><script type="math/tex">n\in \mathbb{R}</script></span>)，使拟合的结果不断地逼近初始的锯齿形波：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 不同阶数三角函数叠加结果示意</span>
<span class="n">figure</span><span class="p">;</span>
<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="n">fplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;三阶拟合&#39;</span><span class="p">);</span>

<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span><span class="n">fplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;四阶拟合&#39;</span><span class="p">);</span>

<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span><span class="n">fplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;五阶拟合&#39;</span><span class="p">);</span>

<span class="n">z</span> <span class="p">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span><span class="n">fplot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;六阶拟合&#39;</span><span class="p">);</span>

<span class="k">function</span><span class="w"> </span><span class="nf">fplot</span><span class="p">(</span>t,y,z<span class="p">)</span><span class="w"></span>
<span class="n">hold</span> <span class="n">on</span><span class="p">;</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span> 
    <span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.5</span><span class="o">*</span><span class="nb">pi</span><span class="p">],[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">6.6</span><span class="o">*</span><span class="nb">pi</span><span class="p">]);</span>
    <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">3.3</span> <span class="mf">3.3</span><span class="p">]);</span>
    <span class="n">box</span> <span class="n">on</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</td></tr></table>

<p><img alt="锯齿形波三阶到六阶拟合结果" src="../res/基础概念/Fourier/六阶拟合.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 锯齿形波三阶到六阶拟合结果</div>
</center>
<!-- <center>图. 锯齿形波三到六阶拟合结果</center> --></p>
<p>从上面的例子可以看到，为了拟合一个周期函数，我们需要使用多种不同周期的三角函数，调整他们的振幅并叠加。那么，给定任意一个周期函数，是否都能将其表示为三角函数和的形式？如果可以表示，则每个用于叠加的三角函数周期是多少？函数振幅又是多少？</p>
<p>傅立叶针对上述问题进行研究，设计出了无穷级数形式的周期函数展开方法，后人称该周期函数展开方法为傅立叶级数（Fourier Series）。傅立叶宣称，任何周期函数（无论连续与否）皆可用傅立叶级数表示。傅立叶级数给出了周期函数展开成三角函数的理论证明，确定了展开式中各项的周期和振幅。但在级数使用范围这一问题上，傅立叶的结论并不准确，德国数学家狄利克雷证明了某些情况下的周期函数无法用傅立叶级数表示，并率先给出了周期函数可展开成傅立叶级数的条件，即狄利克雷条件：
<!-- 他考虑单变量周期函数形成的向量空间，并以无限多个余弦和正弦函数构成单范正交集，由此设计出无穷级数形式的展开式，后人称为傅立叶级数(Fourier series)。 --></p>
<ol>
<li>此函数必须是有界的(bounded)，即对于任意<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>，<span><span class="MathJax_Preview">|f(x)|&lt;M</span><script type="math/tex">|f(x)|<M</script></span>，<span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>是一正实数；</li>
<li>在任意区间内，除了有限个不连续点，<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>必须是连续函数；</li>
<li>在任意区间内，<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>必须仅包含有限个极值；</li>
<li>在一周期内，<span><span class="MathJax_Preview">|f(x)|</span><script type="math/tex">|f(x)|</script></span>的积分必须收敛。</li>
</ol>
<p>尽管适用性限定于满足迪利克雷条件的函数，傅立叶级数现今已然是应用数学的基本工具，在信号处理、图像处理、计量经济、震动分析、声学、光学等领域都有广泛的应用。</p>
<p>本文剩余部分将介绍傅立叶级数的具体内容，探究其将周期函数分解为三角函数和的过程。</p>
<p>从上文的分析中我们知道，傅立叶级数分解周期函数，本质上只需要解决两个问题：
<strong>1. 周期函数的分解结果应该包含哪些项？</strong>
<strong>2. 每一项的系数分别是多少？</strong></p>
<p>首先回答第一个问题：
遵循从特殊到一般的规律，我们先考虑一种特殊的函数——常数函数。对于常数函数，相隔任意位置取值的结果都相同，因此根据周期函数的定义，常数函数是周期函数且周期可以是任意实数。常数本身已经是最简的形式，因此，对常数函数进行分解，结果应该只包含唯一的常数项。更一般的，对任意一个包含常数分量的周期函数，其分解结果中一定包含一个常数项。</p>
<p>接下来我们考虑，除常数项外，周期函数的分解结果还应该包含哪些项？
<!-- 如何用<span><span class="MathJax_Preview">sin(x)</span><script type="math/tex">sin(x)</script></span>和<span><span class="MathJax_Preview">cos(x)</span><script type="math/tex">cos(x)</script></span>进行分解，考虑以下几个问题：
**(1). 分解结果中是否同时含有<span><span class="MathJax_Preview">sin(x)</span><script type="math/tex">sin(x)</script></span>和<span><span class="MathJax_Preview">cos(x)</span><script type="math/tex">cos(x)</script></span>？** -->
我们知道三角函数包括<span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>和<span><span class="MathJax_Preview">\cos(x)</span><script type="math/tex">\cos(x)</script></span>，其中<span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>是奇函数，而<span><span class="MathJax_Preview">\cos(x)</span><script type="math/tex">\cos(x)</script></span>是偶函数。如果分别用<span><span class="MathJax_Preview">f_{odd}(x)</span><script type="math/tex">f_{odd}(x)</script></span>和<span><span class="MathJax_Preview">f_{even}(x)</span><script type="math/tex">f_{even}(x)</script></span>分别表示奇函数和偶函数，则函数运算的奇偶性可以表示为：</p>
<div>
<div class="MathJax_Preview">
f_{odd} = f_{odd} \pm f_{odd}\\
f_{even} = f_{even} \pm f_{even}
</div>
<script type="math/tex; mode=display">
f_{odd} = f_{odd} \pm f_{odd}\\
f_{even} = f_{even} \pm f_{even}
</script>
</div>
<p>即奇函数与奇函数相加减只能得到奇函数，偶函数与偶函数相加减只能得到偶函数。而任意函数<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>，都可以被表示为：</p>
<div>
<div class="MathJax_Preview">
f(x) = \frac{f(x)+f(-x)}{2} + \frac{f(x)-f(-x)}{2}
</div>
<script type="math/tex; mode=display">
f(x) = \frac{f(x)+f(-x)}{2} + \frac{f(x)-f(-x)}{2}
</script>
</div>
<p>显然<span><span class="MathJax_Preview">f(x)+f(-x)</span><script type="math/tex">f(x)+f(-x)</script></span>是偶函数，而<span><span class="MathJax_Preview">f(x)-f(-x)</span><script type="math/tex">f(x)-f(-x)</script></span>是奇函数，因此可以得到结论：对任意函数<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>（无论奇偶）进行分解，其结果一定同时包含奇函数和偶函数。因此，单独使用<span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>或<span><span class="MathJax_Preview">\cos(x)</span><script type="math/tex">\cos(x)</script></span>都无法表示所有的周期函数分解结果，分解一个一般的周期函数，一定需要同时使用<span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>和<span><span class="MathJax_Preview">\cos(x)</span><script type="math/tex">\cos(x)</script></span>。</p>
<!-- **(2). 如何保证三角函数组合的周期与输入函数的周期相同？** -->

<p>我们现在已经知道，周期函数的分解结果一定同时包含<span><span class="MathJax_Preview">\sin(x)</span><script type="math/tex">\sin(x)</script></span>项和<span><span class="MathJax_Preview">\cos(x)</span><script type="math/tex">\cos(x)</script></span>项，接下来需要确定每个三角函数项的周期应该是多少？显然，当分解一个周期为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>的函数时，如果能够保证每个分解分量的周期都为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>，那么他们相加结果的周期一定等于<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>。对三角函数而言，周期为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>的三角函数都可以表示为：<span><span class="MathJax_Preview">sin(\frac{2\pi n}{T}x)</span><script type="math/tex">sin(\frac{2\pi n}{T}x)</script></span>或<span><span class="MathJax_Preview">cos(\frac{2\pi n}{T}x)</span><script type="math/tex">cos(\frac{2\pi n}{T}x)</script></span>，其中<span><span class="MathJax_Preview">n\in \mathbb{N}</span><script type="math/tex">n\in \mathbb{N}</script></span>。因此，如果已知输入函数的周期<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>，则使用<span><span class="MathJax_Preview">sin(\frac{2\pi n}{T}x)</span><script type="math/tex">sin(\frac{2\pi n}{T}x)</script></span>或<span><span class="MathJax_Preview">cos(\frac{2\pi n}{T}x)</span><script type="math/tex">cos(\frac{2\pi n}{T}x)</script></span>进行加减，一定能保证组合的结果与输入函数的周期相同。</p>
<p>通过以上分析，我们可以得到，当分解一个周期函数，其分解结果应该满足以下三点：</p>
<ul>
<li>有常数项</li>
<li>同时包含<span><span class="MathJax_Preview">sin(x)</span><script type="math/tex">sin(x)</script></span>和<span><span class="MathJax_Preview">cos(x)</span><script type="math/tex">cos(x)</script></span> （奇函数和偶函数可以组合出任意函数）</li>
<li>所有分量，最小周期都为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>或<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>的整数分之一</li>
</ul>
<p>故给定一个周期为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>的函数<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>，其三角函数分解的结果可以表示为：</p>
<div>
<div class="MathJax_Preview">
f(x)=C+\sum_{n=1}^{\infty}\left(a_{n} \cos \left(\frac{2 \pi n}{T} x\right)+b_{n} \sin \left(\frac{2 \pi n}{T} x\right)\right), C \in \mathbb{R}
</div>
<script type="math/tex; mode=display">
f(x)=C+\sum_{n=1}^{\infty}\left(a_{n} \cos \left(\frac{2 \pi n}{T} x\right)+b_{n} \sin \left(\frac{2 \pi n}{T} x\right)\right), C \in \mathbb{R}
</script>
</div>
<p>通过上面的式子，我们用一组最基础的三角函数，实现了对任意周期函数的表示。</p>
<p>接下来解决第二个问题：如何确定上式中各分解项的系数？</p>
<!-- $$
C\quad a_n\quad b_n
$$ -->

<p>在上面的求和式中，除系数外的其他部分（即<span><span class="MathJax_Preview">cos(\frac{2 \pi n}{T} x)</span><script type="math/tex">cos(\frac{2 \pi n}{T} x)</script></span>和<span><span class="MathJax_Preview">sin(\frac{2 \pi n}{T} x)</span><script type="math/tex">sin(\frac{2 \pi n}{T} x)</script></span>）不会随<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>的不同而变化，而常数项<span><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span>也可以认为是在<span><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>的基础上针对不同<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>进行缩放的结果。因此，我们可以把</p>
<div>
<div class="MathJax_Preview">
\{1,cos(\frac{2 \pi n}{T} x),sin(\frac{2 \pi n}{T} x)\}
</div>
<script type="math/tex; mode=display">
\{1,cos(\frac{2 \pi n}{T} x),sin(\frac{2 \pi n}{T} x)\}
</script>
</div>
<p>视作一组基底，而把系数<span><span class="MathJax_Preview">\{C\; a_n\; b_n\}</span><script type="math/tex">\{C\; a_n\; b_n\}</script></span>视为<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>在这组基底下的坐标。有了这个结论之后，我们再来看如何求坐标。</p>
<p>我们先看个向量的例子，假设<span><span class="MathJax_Preview">\vec{u}</span><script type="math/tex">\vec{u}</script></span>和<span><span class="MathJax_Preview">\vec{v}</span><script type="math/tex">\vec{v}</script></span>是两个相互正交的向量基底（即<span><span class="MathJax_Preview">\vec{u} \cdot \vec{v} = 0</span><script type="math/tex">\vec{u} \cdot \vec{v} = 0</script></span>），则任意向量<span><span class="MathJax_Preview">\vec{w}</span><script type="math/tex">\vec{w}</script></span>可以通过<span><span class="MathJax_Preview">\vec{u}</span><script type="math/tex">\vec{u}</script></span>和<span><span class="MathJax_Preview">\vec{v}</span><script type="math/tex">\vec{v}</script></span>的线性组合得到：</p>
<div>
<div class="MathJax_Preview">
\vec{w}=a \vec{u}+b \vec{v}
</div>
<script type="math/tex; mode=display">
\vec{w}=a \vec{u}+b \vec{v}
</script>
</div>
<p>例如当<span><span class="MathJax_Preview">a=2, b=3</span><script type="math/tex">a=2, b=3</script></span>时，<span><span class="MathJax_Preview">\vec{w}</span><script type="math/tex">\vec{w}</script></span>的图示为</p>
<p><img alt="正交基示意" src="../res/基础概念/Fourier/正交基.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 正交基示意</div>
</center>
<!-- <center>图. 正交基示意</center> --></p>
<p>显然，在这种情况下，对任意<span><span class="MathJax_Preview">\vec{w}</span><script type="math/tex">\vec{w}</script></span>，正交基的系数（<span><span class="MathJax_Preview">a</span><script type="math/tex">a</script></span>或<span><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span>）等于<span><span class="MathJax_Preview">\vec{w}</span><script type="math/tex">\vec{w}</script></span>在该正交基上的投影除以该正交基的长度，即：</p>
<div>
<div class="MathJax_Preview">
a = \frac{\vec{w} \cdot \vec{u}}{\vec{u} \cdot \vec{u}}=\frac{(1,5) \cdot(-1,1)}{(-1,1) \cdot(-1,1)}=2
</div>
<script type="math/tex; mode=display">
a = \frac{\vec{w} \cdot \vec{u}}{\vec{u} \cdot \vec{u}}=\frac{(1,5) \cdot(-1,1)}{(-1,1) \cdot(-1,1)}=2
</script>
</div>
<p>我们将上述结论推广到三角函数基中（即<span><span class="MathJax_Preview">sin(nt)</span><script type="math/tex">sin(nt)</script></span>和<span><span class="MathJax_Preview">cos(nt)</span><script type="math/tex">cos(nt)</script></span>），在无限维的希尔伯特空间中，函数向量的点积可以定义：</p>
<div>
<div class="MathJax_Preview">
\overrightarrow{f(x)} \cdot \overrightarrow{g(x)}=\int_{0}^{T} f(x) g(x) d x
</div>
<script type="math/tex; mode=display">
\overrightarrow{f(x)} \cdot \overrightarrow{g(x)}=\int_{0}^{T} f(x) g(x) d x
</script>
</div>
<p>其中，<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>是函数向量，<span><span class="MathJax_Preview">g(x)</span><script type="math/tex">g(x)</script></span>是基，<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>是<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>的周期。那么，对于我们之前分析的三角函数基底</p>
<div>
<div class="MathJax_Preview">
\{1,\cos(\frac{2 \pi n}{T} x),\sin(\frac{2 \pi n}{T} x)\}
</div>
<script type="math/tex; mode=display">
\{1,\cos(\frac{2 \pi n}{T} x),\sin(\frac{2 \pi n}{T} x)\}
</script>
</div>
<p>显然该集合中的任意两基底互相正交：</p>
<div>
<div class="MathJax_Preview">
\overrightarrow{\sin} (\frac{2 \pi n}{T} x) \cdot \overrightarrow{\cos} (\frac{2 \pi n}{T} x)=\int_{0}^{T} \sin (\frac{2 \pi n}{T} x) \cdot \cos (\frac{2 \pi n}{T} x) d t=0
</div>
<script type="math/tex; mode=display">
\overrightarrow{\sin} (\frac{2 \pi n}{T} x) \cdot \overrightarrow{\cos} (\frac{2 \pi n}{T} x)=\int_{0}^{T} \sin (\frac{2 \pi n}{T} x) \cdot \cos (\frac{2 \pi n}{T} x) d t=0
</script>
</div>
<p>既然是正交基，那么根据刚才的分析，<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>在这组基底下的坐标等于：</p>
<div>
<div class="MathJax_Preview">
a_{n}=\frac{\int_{0}^{T} f(x) \cos \left(\frac{2 \pi n}{T} x\right) d x}{\int_{0}^{T} \cos ^{2}\left(\frac{2 \pi n}{T} x\right) d x}=\frac{2}{T} \int_{0}^{T} f(x) \cos \left(\frac{2 \pi n}{T} x\right) d x
</div>
<script type="math/tex; mode=display">
a_{n}=\frac{\int_{0}^{T} f(x) \cos \left(\frac{2 \pi n}{T} x\right) d x}{\int_{0}^{T} \cos ^{2}\left(\frac{2 \pi n}{T} x\right) d x}=\frac{2}{T} \int_{0}^{T} f(x) \cos \left(\frac{2 \pi n}{T} x\right) d x
</script>
</div>
<div>
<div class="MathJax_Preview">
b_{n}=\frac{\int_{0}^{T} f(x) \sin \left(\frac{2 \pi n}{T} x\right) d x}{\int_{0}^{T} \sin ^{2}\left(\frac{2 \pi n}{T} x\right) d x}=\frac{2}{T} \int_{0}^{T} f(x) \sin \left(\frac{2 \pi n}{T} x\right) d x
</div>
<script type="math/tex; mode=display">
b_{n}=\frac{\int_{0}^{T} f(x) \sin \left(\frac{2 \pi n}{T} x\right) d x}{\int_{0}^{T} \sin ^{2}\left(\frac{2 \pi n}{T} x\right) d x}=\frac{2}{T} \int_{0}^{T} f(x) \sin \left(\frac{2 \pi n}{T} x\right) d x
</script>
</div>
<div>
<div class="MathJax_Preview">
C =\frac{\int_{0}^{T} f(x) d x}{\int_{0}^{T} d x}=\frac{1}{T} \int_{0}^{T} f(x) d x
</div>
<script type="math/tex; mode=display">
C =\frac{\int_{0}^{T} f(x) d x}{\int_{0}^{T} d x}=\frac{1}{T} \int_{0}^{T} f(x) d x
</script>
</div>
<p>最终我们可以得到</p>
<div>
<div class="MathJax_Preview">
f(x)=\frac{a_{0}}{2}+\sum_{n=1}^{\infty}\left(a_{n} \cos \left(\frac{2 \pi n x}{T}\right)+b_{n} \sin \left(\frac{2 \pi n x}{T}\right)\right)
</div>
<script type="math/tex; mode=display">
f(x)=\frac{a_{0}}{2}+\sum_{n=1}^{\infty}\left(a_{n} \cos \left(\frac{2 \pi n x}{T}\right)+b_{n} \sin \left(\frac{2 \pi n x}{T}\right)\right)
</script>
</div>
<p>其中：</p>
<div>
<div class="MathJax_Preview">
{a_{n}=\frac{2}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot \cos \left(\frac{2 \pi n x}{T}\right) d x, n \in\{0\} \bigcup \mathbb{N}}
</div>
<script type="math/tex; mode=display">
{a_{n}=\frac{2}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot \cos \left(\frac{2 \pi n x}{T}\right) d x, n \in\{0\} \bigcup \mathbb{N}}
</script>
</div>
<div>
<div class="MathJax_Preview">
{b_{n}=\frac{2}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot \sin \left(\frac{2 \pi n x}{T}\right) d x, n \in \mathbb{N}}
</div>
<script type="math/tex; mode=display">
{b_{n}=\frac{2}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot \sin \left(\frac{2 \pi n x}{T}\right) d x, n \in \mathbb{N}}
</script>
</div>
<p>此外，根据欧拉公式：<span><span class="MathJax_Preview">e^{jx}=\cos(x)+j\sin(x)</span><script type="math/tex">e^{jx}=\cos(x)+j\sin(x)</script></span>和<span><span class="MathJax_Preview">e^{-jx}=\cos(x)-j\sin(x)</span><script type="math/tex">e^{-jx}=\cos(x)-j\sin(x)</script></span>，我们可以得到</p>
<div>
<div class="MathJax_Preview">
\cos(x) = \frac{e^{jx}+e^{-jx}}{2} \qquad
\sin(x) = \frac{e^{jx}-e^{-jx}}{2}
</div>
<script type="math/tex; mode=display">
\cos(x) = \frac{e^{jx}+e^{-jx}}{2} \qquad
\sin(x) = \frac{e^{jx}-e^{-jx}}{2}
</script>
</div>
<p>代入到用正余弦表示的傅立叶级数展开式中，我们就得到了傅立叶级数的复数表达式：</p>
<div>
<div class="MathJax_Preview">
f(x) = \frac{a_0}{2}+\sum_{n=1}^{\infty}(\frac{a_n+b_n}{2}\cdot e^{jx}+\frac{a_n-b_n}{2}\cdot e^{-jx})
</div>
<script type="math/tex; mode=display">
f(x) = \frac{a_0}{2}+\sum_{n=1}^{\infty}(\frac{a_n+b_n}{2}\cdot e^{jx}+\frac{a_n-b_n}{2}\cdot e^{-jx})
</script>
</div>
<p>至此，给定任意一个满足迪利克雷条件的周期函数，我们都能将其转化为三角函数的线性组合，并且可以准确求出对于每一阶三角函数，对应的傅立叶系数(Fourier Coefficient)应该是多少。</p>
<p>接下来，我们用一个例子，带大家更直观地理解傅立叶级数的计算过程。考虑我们有一个周期为<span><span class="MathJax_Preview">2\pi</span><script type="math/tex">2\pi</script></span>的方波，现在需要将其展开为三角函数表示的无穷级数形式。
首先使用MATLAB构造周期为<span><span class="MathJax_Preview">2\pi</span><script type="math/tex">2\pi</script></span>的方波函数：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 方波的傅立叶级数展开</span>
<span class="c">% 构造周期为2pi的方波</span>
<span class="n">fs</span> <span class="p">=</span> <span class="mf">1e3</span><span class="p">;</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">:</span><span class="mi">6</span><span class="o">*</span><span class="nb">pi</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">square</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">50</span><span class="p">);</span>
<span class="n">figure</span><span class="p">;</span>
    <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
    <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
</pre></div>
</td></tr></table>

<p><img alt="MATLAB构造周期为2pi的矩形波" src="../res/基础概念/Fourier/方波.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. MATLAB构造周期为2pi的矩形波</div>
</center></p>
<p>根据傅立叶级数，我们可以计算每一阶三角函数对应的傅立叶系数：</p>
<div>
<div class="MathJax_Preview">
\begin{aligned}
    a_{n} &amp;= \frac{1}{\pi} \int_{0}^{2\pi} f(x) \cdot \cos (n x) d x \\
    &amp;= \frac{1}{\pi} \int_{0}^{\pi} 1 \cdot \cos (n x) d x + \frac{1}{\pi} \int_{\pi}^{2\pi} -1 \cdot \cos \left(n x\right) dx.
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
    a_{n} &= \frac{1}{\pi} \int_{0}^{2\pi} f(x) \cdot \cos (n x) d x \\
    &= \frac{1}{\pi} \int_{0}^{\pi} 1 \cdot \cos (n x) d x + \frac{1}{\pi} \int_{\pi}^{2\pi} -1 \cdot \cos \left(n x\right) dx.
\end{aligned}
</script>
</div>
<p>类似的，</p>
<div>
<div class="MathJax_Preview">
\begin{aligned}
b_{n}&amp;=\frac{1}{\pi} \int_{0}^{2\pi} f(x) \cdot \sin \left(n x\right) d x \\
&amp;= \frac{1}{\pi} \int_{0}^{\pi} 1 \cdot \sin \left(n x\right) d x + \frac{1}{\pi} \int_{\pi}^{2\pi} -1 \cdot \sin \left(n x\right) dx.
\end{aligned}
</div>
<script type="math/tex; mode=display">
\begin{aligned}
b_{n}&=\frac{1}{\pi} \int_{0}^{2\pi} f(x) \cdot \sin \left(n x\right) d x \\
&= \frac{1}{\pi} \int_{0}^{\pi} 1 \cdot \sin \left(n x\right) d x + \frac{1}{\pi} \int_{\pi}^{2\pi} -1 \cdot \sin \left(n x\right) dx.
\end{aligned}
</script>
</div>
<p>因此，我们可以使用上面的式子，在MATLAB中计算展开成无穷级数后，各阶三角函数的傅立叶系数：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">% 计算傅立叶系数</span>
<span class="n">z</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
<span class="n">syms</span> <span class="n">x</span><span class="p">;</span>
<span class="k">for</span> <span class="nb">i</span> <span class="p">=</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">11</span>
    <span class="c">% cos(nx)的傅立叶系数</span>
    <span class="n">Fx1</span> <span class="p">=</span> <span class="mi">1</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
    <span class="n">Fx2</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
    <span class="n">an</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="nb">pi</span><span class="o">*</span><span class="n">double</span><span class="p">(</span><span class="n">int</span><span class="p">(</span><span class="n">Fx1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">pi</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="nb">pi</span><span class="o">*</span><span class="n">double</span><span class="p">(</span><span class="n">int</span><span class="p">(</span><span class="n">Fx2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="nb">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">));</span>
    <span class="c">% sin(nx)的傅立叶系数</span>
    <span class="n">Fx1</span> <span class="p">=</span> <span class="mi">1</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
    <span class="n">Fx2</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">x</span><span class="p">);</span>
    <span class="n">bn</span> <span class="p">=</span> <span class="mi">1</span><span class="o">/</span><span class="nb">pi</span><span class="o">*</span><span class="n">double</span><span class="p">(</span><span class="n">int</span><span class="p">(</span><span class="n">Fx1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nb">pi</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="nb">pi</span><span class="o">*</span><span class="n">double</span><span class="p">(</span><span class="n">int</span><span class="p">(</span><span class="n">Fx2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="nb">pi</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="p">));</span>

    <span class="n">z</span> <span class="p">=</span> <span class="n">z</span> <span class="o">+</span> <span class="n">an</span><span class="o">*</span><span class="nb">cos</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">bn</span><span class="o">*</span><span class="nb">sin</span><span class="p">(</span><span class="nb">i</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
    <span class="c">% 绘图</span>
    <span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">ceil</span><span class="p">(</span><span class="nb">i</span><span class="o">/</span><span class="mi">2</span><span class="p">));</span><span class="n">hold</span> <span class="n">on</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;black&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="s">&#39;color&#39;</span><span class="p">,</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="s">&#39;linewidth&#39;</span><span class="p">,</span><span class="mf">1.5</span><span class="p">);</span>
        <span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span> <span class="mi">2</span><span class="p">]);</span>
<span class="k">end</span>
</pre></div>
</td></tr></table>

<p><img alt="矩形波傅立叶级数展开" src="../res/基础概念/Fourier/矩形波傅立叶.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 矩形波傅立叶级数展开</div>
</center></p>
<h3 id="22">2.2 傅里叶变换<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<p>使用傅立叶级数，我们可以将任意满足迪利克雷条件的周期函数，展开成正弦信号和余弦信号的和。由于展开式中的每一个正弦和余弦分量仅包含单一的频率，因此我们可以进而从中提取信号中各频率分量的强度——即信号频谱。至此，我们利用傅立叶级数，最终实现了信号从时域到频域的转换。</p>
<p><img alt="傅立叶级数实现信号从时域到频域的转换" src="../res/基础概念/Fourier/Fourier_synthesis.svg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 傅立叶级数实现信号从时域到频域的转换</div>
</center></p>
<p>但是，傅立叶级数仅仅适用于满足迪利克雷条件的周期函数，对于更一般的非周期函数，我们又该如何将它从时域转换到频域呢？为了解决这一问题，傅立叶公爵在傅立级数的基础上进一步提出了傅立叶变换(Fourier Transform)的方法，用于实现非周期的一般信号在时域和频域之间的变换。</p>
<p>在傅立叶级数中，输入的信号必须是周期信号，时域信号的周期<span><span class="MathJax_Preview">T_0</span><script type="math/tex">T_0</script></span>决定了频域上相邻两个输出之间的距离，即<span><span class="MathJax_Preview">\delta f = \frac{1}{T_0}</span><script type="math/tex">\delta f = \frac{1}{T_0}</script></span>。当输入信号的周期不断增大，得到频域输出之间的距离随之不断减少。当周期<span><span class="MathJax_Preview">T_0</span><script type="math/tex">T_0</script></span>不断增加直至趋近于<span><span class="MathJax_Preview">\infty</span><script type="math/tex">\infty</script></span>，此时周期信号退化为非周期性的一般时域信号，而该信号对应的频域输出距离此时也趋近于<span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>，即非周期的时域信号对应一连续的频域输出。</p>
<p><img alt="从傅立叶级数到傅立叶变换" src="../res/基础概念/Fourier/傅立叶变换.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 从傅立叶级数到傅立叶变换</div>
</center></p>
<p>讲到这，我们先暂停一会，花一点时间思考：频域连续究竟意味着什么？在之前介绍傅立叶级数的时候，我们说过傅立叶级数源于一个“使用三角函数对周期函数进行分解”的猜想。在分解一个周期为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>、且满足迪利克雷条件的函数时，我们所作的工作是选取以<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>为周期的正余弦函数做为基底，计算目标函数在各个基底上的投影。由于基底的频率是离散的(<span><span class="MathJax_Preview">n\times\delta f = \frac{n}{T}</span><script type="math/tex">n\times\delta f = \frac{n}{T}</script></span>)，因此频域的输出也是离散的。参考这一过程，当某个函数<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>的频域输出为连续值，说明要分解<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>，需要使用所有频率的正余弦做为基底（而不仅仅是周期为<span><span class="MathJax_Preview">T</span><script type="math/tex">T</script></span>的正余弦函数），因此<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>的分解可以表示为：</p>
<div>
<div class="MathJax_Preview">
f(x)=\sum_{n=-\infty}^{\infty} c_{n} \cdot e^{i \frac{2 \pi n x}{T}} \Longrightarrow f(x)=\int_{-\infty}^{\infty} F(\omega) e^{i \omega x} d \omega
</div>
<script type="math/tex; mode=display">
f(x)=\sum_{n=-\infty}^{\infty} c_{n} \cdot e^{i \frac{2 \pi n x}{T}} \Longrightarrow f(x)=\int_{-\infty}^{\infty} F(\omega) e^{i \omega x} d \omega
</script>
</div>
<p>其中，<span><span class="MathJax_Preview">F(\omega)</span><script type="math/tex">F(\omega)</script></span>表示频率<span><span class="MathJax_Preview">\omega</span><script type="math/tex">\omega</script></span>处的傅立叶系数，参考复数形式傅立叶级数中求系数的方法，当<span><span class="MathJax_Preview">T\rightarrow\infty</span><script type="math/tex">T\rightarrow\infty</script></span>，可以得到频率<span><span class="MathJax_Preview">\omega</span><script type="math/tex">\omega</script></span>处的系数<span><span class="MathJax_Preview">F(\omega)</span><script type="math/tex">F(\omega)</script></span>：</p>
<div>
<div class="MathJax_Preview">
{c_{n}=\frac{1}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot e^{-i \frac{2 \pi n x}{T}} d x} \Rightarrow F(\omega)=\frac{1}{2 \pi} \int_{-\infty}^{\infty} f(x) e^{-i \omega x} d x
</div>
<script type="math/tex; mode=display">
{c_{n}=\frac{1}{T} \int_{x_{0}}^{x_{0}+T} f(x) \cdot e^{-i \frac{2 \pi n x}{T}} d x} \Rightarrow F(\omega)=\frac{1}{2 \pi} \int_{-\infty}^{\infty} f(x) e^{-i \omega x} d x
</script>
</div>
<p>显然<span><span class="MathJax_Preview">F(\omega)</span><script type="math/tex">F(\omega)</script></span>就是<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>对应到频域上的输出，从<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>到<span><span class="MathJax_Preview">F(\omega)</span><script type="math/tex">F(\omega)</script></span>的过程就是傅立叶变换(Fourier Transform, FT)。反之，从<span><span class="MathJax_Preview">F(\omega)</span><script type="math/tex">F(\omega)</script></span>到<span><span class="MathJax_Preview">f(x)</span><script type="math/tex">f(x)</script></span>的过程称为傅立叶逆变换(Inverse Fourier Transform, IFT)。显然，和傅立叶级数一样，能进行傅立叶变换的时域信号必须满足迪利克雷条件。</p>
<h3 id="23">2.3 离散傅里叶变换<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<p>傅里叶变换要求的输入是连续信号，而如我们在第一节所讨论的，计算机可以处理的信号只能是通过采样得到的离散信号。因此，在傅里叶变换的基础上，我们提出了离散傅里叶变换（Discrete Fourier Transform, DFT），它可以将离散的时域采样信号变换到。对于<span><span class="MathJax_Preview">N</span><script type="math/tex">N</script></span>点序列<span><span class="MathJax_Preview">\{x[n]\}_{0 \leq n&lt;N}</span><script type="math/tex">\{x[n]\}_{0 \leq n<N}</script></span>，它的DFT为</p>
<div>
<div class="MathJax_Preview">
\hat{x}[k]=\sum_{n=0}^{N-1} e^{-i \frac{2 \pi}{N} n k} x[n] \quad k=0,1, \ldots, N-1
</div>
<script type="math/tex; mode=display">
\hat{x}[k]=\sum_{n=0}^{N-1} e^{-i \frac{2 \pi}{N} n k} x[n] \quad k=0,1, \ldots, N-1
</script>
</div>
<p>DFT的逆变换（IDFT）为：</p>
<div>
<div class="MathJax_Preview">
x[n]=\frac{1}{N} \sum_{k=0}^{N-1} e^{i \frac{2 \pi}{N} n k} \hat{x}[k] \quad n=0,1, \ldots, N-1
</div>
<script type="math/tex; mode=display">
x[n]=\frac{1}{N} \sum_{k=0}^{N-1} e^{i \frac{2 \pi}{N} n k} \hat{x}[k] \quad n=0,1, \ldots, N-1
</script>
</div>
<p>实际上，DFT和IDFT变换式中和式前面的归一化系数并不重要。在上面的定义中，DFT和IDFT前的系数分别为1和<span><span class="MathJax_Preview">\frac{1}{N}</span><script type="math/tex">\frac{1}{N}</script></span>，有时会将这两个系数都改成<span><span class="MathJax_Preview">\frac{1}{\sqrt{N}}</span><script type="math/tex">\frac{1}{\sqrt{N}}</script></span>。</p>
<p>DFT虽然可以计算有限时间内的频谱，但它的计算复杂度是<span><span class="MathJax_Preview">O(n^2)</span><script type="math/tex">O(n^2)</script></span>的，计算量过大，限制了在实际中的应用。下面我们介绍的FFT算法可以把DFT的计算复杂度降为<span><span class="MathJax_Preview">O(n\log n)</span><script type="math/tex">O(n\log n)</script></span>，从而将傅里叶变换推往实用。</p>
<h3 id="24-fft">2.4 快速傅里叶变换 (FFT)<a class="headerlink" href="#24-fft" title="Permanent link">&para;</a></h3>
<p>在20世纪60年代中期，一种称之为快速傅里叶变换（Fast Fourier Transform, FFT）的算法被引入，它是快速计算序列的离散傅里叶变换（DFT）或其逆变换的方法。这一算法在1965年被库利（Cooley）和图基（Tukey）独立地发现，其实它也有相当长的历史。事实上，这一算法在高斯的手稿中已能找到。之所以使得它成为重要的近代发现是由于FFT被证明是非常适合于高效的数字实现，并且它将计算变换所需要的时间减少了几个数量级。有了这一算法，在利用离散时间傅里叶级数和变换中许多有趣而过去认为不切实际的想法突然变得实际起来，并且使离散时间信号于系统分析技术的发展加速向前迈进。</p>
<p>傅里叶分析将信号从原始域（通常是时间或空间）转换到频域的表示或者逆过来转换。FFT会通过把DFT矩阵分解为稀疏（大多为零）因子之积来快速计算此类变换。因此，它能够将计算DFT的复杂度从只用DFT定义计算需要的 <span><span class="MathJax_Preview">O(n^{2})</span><script type="math/tex">O(n^{2})</script></span>，降低到 <span><span class="MathJax_Preview">O(n\log n)</span><script type="math/tex">O(n\log n)</script></span>，其中 <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> 为数据大小。</p>
<p>快速傅里叶变换广泛的应用于工程、科学和数学领域。这里的基本思想在1965年才得到普及，但早在1805年就已推导出来。1994年美国数学家吉尔伯特·斯特朗把FFT描述为“我们一生中最重要的数值算法”，它还被IEEE科学与工程计算期刊列入20世纪十大算法。</p>
<p><strong>FFT的一个应用：大数乘法</strong></p>
<p>在学习程序设计课程的时候，我们都写过大数乘法，其实现是模拟手工列竖式计算，计算复杂度为<span><span class="MathJax_Preview">O(n^{2})</span><script type="math/tex">O(n^{2})</script></span>。通过FFT，我们可以将大数乘法的复杂度变为<span><span class="MathJax_Preview">O(n\log n)</span><script type="math/tex">O(n\log n)</script></span>。</p>
<p>设<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>和<span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span>是两个很大的数，<span><span class="MathJax_Preview">C=A\cdot B</span><script type="math/tex">C=A\cdot B</script></span>。把这两个数写成多项式的形式，（不足位数补前导零）</p>
<div>
<div class="MathJax_Preview">
A(x)=\sum_{i=0}^{n-1}a_i x^i \qquad
B(x)=\sum_{i=0}^{n-1}b_i x^i
</div>
<script type="math/tex; mode=display">
A(x)=\sum_{i=0}^{n-1}a_i x^i \qquad
B(x)=\sum_{i=0}^{n-1}b_i x^i
</script>
</div>
<p>以下对<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>的叙述对<span><span class="MathJax_Preview">B</span><script type="math/tex">B</script></span>同理。其中<span><span class="MathJax_Preview">a_0, a_1, \cdots, a_{n−1}</span><script type="math/tex">a_0, a_1, \cdots, a_{n−1}</script></span>分别表示<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>的第一位、第二位……第<span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>位。这样我们就能用一个向量<span><span class="MathJax_Preview">(a_0, a_1, \cdots ,a_{n−1})</span><script type="math/tex">(a_0, a_1, \cdots ,a_{n−1})</script></span>来表示<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>，这种表示方法叫做系数表示法，当<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>取10时就是我们常用的十进制。</p>
<p>我们知道多项式除了有系数表示法，还有点值表示法（拉格朗日插值），<span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>个点可以唯一确定一个多项式。例如当我们知道<span><span class="MathJax_Preview">(0, A(0)), (1, A(1)), \cdots, (n-1, A(n-1))</span><script type="math/tex">(0, A(0)), (1, A(1)), \cdots, (n-1, A(n-1))</script></span>这些点时，<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>也就是已知的。</p>
<p>下面我们考虑这样一种计算方法</p>
<ol>
<li>将<span><span class="MathJax_Preview">A, B</span><script type="math/tex">A, B</script></span>的系数表示变为点值表示。</li>
<li>计算点值表示的乘积，即<span><span class="MathJax_Preview">(0, C(0)), \cdots, (n-1, C(n-1))=(0, A(0)\cdot B(0)), \cdots, (n-1, A(n-1)\cdot B(n-1))</span><script type="math/tex">(0, C(0)), \cdots, (n-1, C(n-1))=(0, A(0)\cdot B(0)), \cdots, (n-1, A(n-1)\cdot B(n-1))</script></span></li>
<li><span><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span>的点值表示已经确定了<span><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span>，将其转化为系数表示即求得对应大数乘积。</li>
</ol>
<p>步骤2的复杂度为<span><span class="MathJax_Preview">O(n)</span><script type="math/tex">O(n)</script></span>，但步骤1和3的朴素算法复杂度是<span><span class="MathJax_Preview">O(n^{2})</span><script type="math/tex">O(n^{2})</script></span>，看似没有降低总体的复杂度，但这个思路给了我们优化它的可能。</p>
<p>观察大数的多项式表示，其实是一个求和，而DFT也是一个求和。如果<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>取为DFT里对应各频率的单位复根（点值表示法的取点是任意的，我们可以在复平面上任取<span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span>个点），那么“将<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>的系数表示变为点值表示”这一操作等价于“求解<span><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span>的离散傅里叶变换”，点值表示化为系数表示则对应于逆傅里叶变换。由于FFT的存在，步骤1和3的算法复杂度都变成了<span><span class="MathJax_Preview">O(n\log n)</span><script type="math/tex">O(n\log n)</script></span>，于是总体计算大数乘法的时间复杂度也变成了<span><span class="MathJax_Preview">O(n\log n)</span><script type="math/tex">O(n\log n)</script></span>。</p>
<!-- ### 2.5 离散时间傅里叶变换
### 2.6 拉普拉斯变换
### 2.7 Z变换
### 2.8 短时傅里叶变换 (STFT)
### 2.9 小波变换
### 2.10 线性时不变系统 -->

<h2 id="3">3. 信道<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<p>信道又被称为通道、频道和波道，是信号在通信系统中传输的通道，由信号从发射端传输到接收端所经过的传输媒质所构成。广义的信道定义除了包括传输媒质，还包括传输信号的相关设备。
在学习这一部分的过程中，我们始终要围绕着下面的问题：
什么是信道，怎么样来表示这个信道。
信号传输里面两个重要的事情，就是如何表示信号（调制），以及如何表示信道（传输的影响）。传输最终要做的事情就是通过接收到的信号，还原出发送的信号。</p>
<p><strong>狭义信道</strong></p>
<p>按照传输媒质来划分，可以分为有线信道、无线信道和存储信道三类。值得注意的是，磁带、磁盘等数据存储媒质也可以被看作是一种通信信道。将数据写入存储媒质的过程即等效于发射机将信号传输到信道的过程，将数据从存储媒质读出的过程即等效于接收机从信道接收信号的过程。</p>
<p><strong>广义信道</strong></p>
<p>按照信道功能进行划分，可以分为调制信道和编码信道两类。</p>
<p>调制信道是指信号从调制器的输出端传输到解调器的输入端经过的部分。对于调制和解调的研究者来说，信号在调制信道上经过的传输媒质和变换设备都对信号做出了某种形式的变换，研究者只关心这些变换的输入和输出的关系，并不关心实现这一系列变换的具体物理过程。这一系列变换的输入与输出之间的关系，通常用多端口时变网络作为调制信道的数学模型进行描述。</p>
<p>编码信道是指数字信号由编码器输出端传输到译码器输入端经过的部分。对于编译码的研究者来说，编码器输出的数字序列经过编码信道上的一系列变换之后，在译码器的输入端成为另一组数字序列，研究者只关心这两组数字序列之间的变换关系，而并不关心这一系列变换发生的具体物理过程，甚至并不关心信号在调制信道上的具体变化。编码器输出的数字序列与到译码器输入的数字序列之间的关系，通常用多端口网络的转移概率作为编码信道的数学模型进行描述。</p>
<!-- <img src="./res/基础概念/cpt_channel.png" width=600px> -->

<p><img alt="" src="../res/基础概念/cpt_channel.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 信道示意</div>
</center></p>
<h3 id="31">3.1 信道状态信息<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p>在无线通信中，信道状态信息（Channel State Information，CSI）指一个通信链路的已知信道信息。CSI描述了一个信号如何从发送端传播到接收端以及相应影响，如散射、衰落和能量随距离的衰减，即信道估计。运用CSI可以依据当前信道状态实行自适应传输，这对多天线系统中实现高速率的可靠通信十分重要。</p>
<p>CSI可以分为瞬时CSI（Instantaneous CSI）和统计CSI（Statistical CSI）。瞬时CSI意味着当前信道状态已知，因此可以调整发射信号来优化接收信号以达到空间复用或减少比特错误率。统计CSI意味着信道的统计特性已知，如衰落分布的类型、平均信道增益、空间相关性等，这些信息也能用来进行传输优化。</p>
<p>在某些快衰落系统中，信道状态在symbol级别都会发生极速的变化，此时只用统计CSI是有意义的。另一方面，在慢衰落系统中，可以在合理精度内得到瞬时CSI估计，在该估计过时前仍可被用来进行传输适应。</p>
<!-- TODO 举例 -->

<h3 id="32">3.2 信道冲击响应<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<!-- TODO 加个图 -->

<p><img alt="" src="../res/基础概念/channel-response-time.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 信道响应示意图，图中代表了单位信号经过信道后产生了不同的延迟和衰减。</div>
</center></p>
<p>信道冲击响应（Channel Impulse Response，CIR），顾名思义，即当输入一个单位脉冲信号时，信道输出端的响应输出信号。</p>
<p>通信信道会对经过的信号产生作用（例如减弱，改变频率等），不同的信道作用效果不一样。因为任何输入信号都可以分解成单位脉冲信号的线性叠加，研究信道对单位脉冲信号的响应是有意义的。对于一个线性系统，输出信号可以用输出端对单位脉冲信号的响应的线性叠加表示。信道冲击响应反映了信道的基本特性。</p>
<p>事实上，信道我们就可以看做一个滤波器，这个滤波器的参数通常我们用<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>来表示，这个参数如上图所示。
如果我们知道了这个信道参数，也就是信道冲击响应的话，那么对于任意输入信号，我们也能够计算出对应的经过信道后的变化。严格的说，对于信号<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>,经过信道后的结果为<span><span class="MathJax_Preview">y=x\times h1</span><script type="math/tex">y=x\times h1</script></span> 其中<span><span class="MathJax_Preview">\times</span><script type="math/tex">\times</script></span>表示卷积。在数据传输中，实际上重要的一个过程就是通过接收到的<span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span>和测量的<span><span class="MathJax_Preview">h</span><script type="math/tex">h</script></span>，计算传输的<span><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>。这其中带来了另外一个重要的问题就是如何来计算信道冲击响应。
当然理想情况下，我们可以在发送端发送一个冲击，然后在接收端测量这一冲击，通过这个方法来计算信道参数。实际上，发送一个理想的冲击信号是很困难的，因此实际上我们可以通过发送已知的其他信号来测量信道冲击相应，比如数据发送过程中的preamble，我们就可以利用来计算信道冲击相应。在实际计算中，我们还可以将时域上的信道冲击响应转化为频率，如下图所示。这样实际上我们比较输入信号和输出信号的频域特征，我们就可以计算出相应频域上的冲击响应，从而计算出相应的时域上的参数。
<img alt="" src="../res/基础概念/channel-response-freq.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 信道响应示意图，图中代表了单位信号经过信道后不同频率的影响。此图和上图时域上的响应是等价的，一个是时间上的表示，一个是频率上的表示，两者可以互相转化。这个参数也是大量定位和感知工作的信息来源，例如信道冲击相应，我们可以计算不同多径路径和直接视距路径LOS。</div>
</center></p>
<h3 id="33">3.3 信噪比<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<p>信噪比（Signal-to-noise ratio，SNR or S/N）用于衡量信号强度与背景噪声强度的关系，定义为信号功率与噪声功率之比。</p>
<div>
<div class="MathJax_Preview">
SNR = \frac{P_{signal}}{P_{noise}} = \frac{A^2_{signal}}{A^2_{noise}}
</div>
<script type="math/tex; mode=display">
SNR = \frac{P_{signal}}{P_{noise}} = \frac{A^2_{signal}}{A^2_{noise}}
</script>
</div>
<p>SNR常使用分贝（dB）作为单位。</p>
<div>
<div class="MathJax_Preview">
SNR(dB) = 10\log_{10} \left(\frac{P_{signal}}{P_{noise}}\right) = 20\log_{10} \left(\frac{A_{signal}}{A_{noise}}\right)
</div>
<script type="math/tex; mode=display">
SNR(dB) = 10\log_{10} \left(\frac{P_{signal}}{P_{noise}}\right) = 20\log_{10} \left(\frac{A_{signal}}{A_{noise}}\right)
</script>
</div>
<p>其中，<span><span class="MathJax_Preview">P_{signal}</span><script type="math/tex">P_{signal}</script></span>为信号功率，<span><span class="MathJax_Preview">P_{noise}</span><script type="math/tex">P_{noise}</script></span>为噪声功率，<span><span class="MathJax_Preview">A_{signal}</span><script type="math/tex">A_{signal}</script></span>为信号振幅，<span><span class="MathJax_Preview">A_{noise}</span><script type="math/tex">A_{noise}</script></span>为噪声振幅。</p>
<p>MATLAB提供了<code>awgn</code>函数用于向目标信号按规定的信噪比加入高斯白噪声，调用示例如下：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fs</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">% sampling frequency</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="c">% Add white Gaussian noise to signal</span>
<span class="c">% snr = 10dB</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;measured&#39;</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]);</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Original Signal&#39;</span><span class="p">,</span> <span class="s">&#39;Signal with AWGN&#39;</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="./res/4.2/cpt_snr.pdf" /></p>
<!-- **因为物联网的主要通信技术为无线通信，下面介绍一些无线通信相关的基础观念。** -->

<h3 id="34">3.4 多径效应<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<p>由于电磁信号所处环境的不同，传播过程中出现折射、反射、漫射、衍射等等现象，在接收端收到了来自多条路径的信号，分为视距路径（Line of Sight）和非视距路径（Not Line of Sight）。多径效应对无线系统有很大影响，常用的解决技术有时域均衡、正交频分复用（OFDM）、Rake接收机、分集接收技术等。</p>
<p><img alt="" src="../res/基础概念/cpt_multipath.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 多径示意图</div>
</center></p>
<h3 id="35">3.5 信号衰落<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<p>在无线通信领域，衰落（Fading）是指由于信道的变化导致接收信号的幅度发生随机变化的现象，即信号衰落。导致信号衰落的信道被称作衰落信道。衰落可按时间、空间、频率，三个角度来分类。 </p>
<p><strong>时间衰落</strong></p>
<p>在时间上，分为慢衰落和快衰落。慢衰落描述的是信号幅度的长期变化，是传播环境在较长时间、较大范围内发生变化的结果，因此又被称为长期衰落、大尺度衰落。快衰落则描述了信号幅度的瞬时变化，与多径传播有关，又被称为短期衰落、小尺度衰落。慢衰落是快衰落的中值。 </p>
<p><strong>空间衰落</strong></p>
<p>在空间上，分为瑞利衰落和莱斯衰落。瑞利衰落适用于从发射机到接收机不存在直射信号的情况；相反，莱斯衰落适用于发射机到接收机存在直射路径的情况。 </p>
<p><strong>频率衰落</strong></p>
<p>在频率上，分为平坦性衰落和选择性衰落。相干带宽是描述时延扩展的指标，是表征多径信道特性的一个重要参数。它是指某一特定的频率范围，在该频率范围内的任意两个频率分量都具有很强的幅度相关性，即在相干带宽范围内，多径信道具有恒定的增益和线性相位。通常，相干带宽近似等于最大多径时延的倒数。从频域看，如果相干带宽小于发送信道的带宽，则该信道特性会导致接收信号波形产生频率选择性衰落，即某些频率成分信号的幅值可以增强，而另外一些频率成分信号的幅值会被削弱。当信号带宽远小于相干带宽时，所有的信号频率呈现出一样的强度衰落，称之为平坦性衰落。</p>
<!-- TODO 加图 -->

<h2 id="4">4. 滤波<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<p>在信号处理(Signal Processing, SP)领域，“滤波”是最古老、也是最经典的话题之一。“滤波”最早出现在模拟电路系统，电子工程师使用模拟滤波器(Analog Filter)消除信号的异常波动，使信号更加平滑。而在计算机领域，我们讨论更多的是“数字滤波”，即对离散的采样信号进行滤波，达到消除特定频率信号分量的目的。</p>
<p>数字滤波器脱胎于模拟滤波器，两者的目标是类似的，都是在信号处理的过程中消除某些频率的信号分量（如低频信号中的高频噪声）。但模拟滤波器的作用对象是连续信号，而数字滤波器处理的是离散的采样点，因此两者在具体实现上有很大的不同。模拟滤波器通常由电容、电感等模拟电子器件组成，主要依仗器件的物理特性实现滤波效果。而数字滤波器则由软件或者数字芯片实现，使用特定的算法对离散采样信号进行处理。在本文中，我们主要讨论数字滤波器的原理及实现方式。</p>
<p><img alt="模拟滤波器与数字滤波器示意" src="../res/基础概念/滤波/filter.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 模拟滤波器与数字滤波器示意</div>
</center></p>
<p>上图展示了模拟滤波器和数字滤波器效果示意，可以看到通过滤波处理后，原本因包含噪声而抖动的信号包络变得平滑。根据傅里叶级数，任何信号都可以看作多个不同频率信号的叠加。因此如果我们将输入信号看作低频的原始信号与高频噪声的叠加，则通过滤波器后，输入信号中的高频噪声被完全过滤了，在输出中只剩下低频的原始信号。由此可得到滤波器的定义：滤波器是指能够容许某些频率的信号分量通过，但减弱（或阻止）另一些频率分量的信号处理模块。</p>
<p>根据通过信号频率的不同，我们将滤波器分为低通、高通、带通和带阻四种类型：</p>
<ul>
<li>低通滤波器：允许信号中的低频或直流分量通过，抑制高频分量或干扰和噪声。</li>
<li>高通滤波器：允许信号中的高频分量通过，抑制低频或直流分量。</li>
<li>带通滤波器：允许一定频段的信号通过，抑制低于或高于该频段的信号、干扰和噪声。</li>
<li>带阻滤波器：抑制一定频段内的信号，允许该频段以外的信号通过。</li>
</ul>
<p>接下来，我们以一个简单的低通滤波器为例，说明滤波器的工作原理：</p>
<p>使用滑动窗口对输入的数据计算滑动平均，就是一个最简单的低通滤波器模型。考虑一组长度有限的非零输入，滤波器首先确定一个长度固定的滑动窗口。以下表中的数据为例，我们使用一个长度为5的滑动窗口，计算某桥梁在五分钟的跨度内，每分钟通过汽车数量的平均值。表格的第二列是每分钟实际通过汽车数，所以滑动平均操作就是从第5个数开始，计算这个数与其前4个数的平均值（如下表第三列的27），该平均值就是滑动平均算法的第一个输出。然后移动滑动窗口，计算下一个数与其前4个数的平均值（如下表第三列的第二个输出40.4）。以此类推，直至所有输入的数都参与过平均值计算。</p>
<p><img alt="平均计算过程" src="../res/基础概念/滤波/avg.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 平均计算过程</div>
</center></p>
<p>MATLAB提供了<code>movmean()</code>函数用于计算滑动平均：</p>
<p><code>M = movmean(A,k)</code> 返回由局部 <code>k</code> 个数据点的均值组成的数组，其中每个均值是基于 <code>A</code> 的相邻元素的长度为 <code>k</code> 的移动窗口计算得出。当 <code>k</code> 为奇数时，窗口以当前位置的元素为中心。当 <code>k</code> 为偶数时，窗口以当前元素及其前一个元素为中心。当没有足够的元素填满窗口时，窗口将自动在端点处截断。当窗口被截断时，只根据窗口内的元素计算平均值。<code>M</code> 与 <code>A</code> 的大小相同。</p>
<p><code>movmean()</code>的第<code>n</code>个输出对应的窗口默认以第<code>n</code>个输入为中心，我们也可以指定第<code>n</code>个窗口在输入序列中的具体位置。<code>M = movmean(A,[kb kf])</code> 通过长度为 <code>kb+kf+1</code> 的窗口计算均值，其中包括当前位置的元素、后面的 <code>kb</code> 个元素和前面的 <code>kf</code> 个元素。</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">% computes a moving average by sliding a window of length len_win.</span>
<span class="n">din</span> <span class="p">=</span> <span class="p">[</span><span class="mi">10</span> <span class="mi">22</span> <span class="mi">24</span> <span class="mi">42</span> <span class="mi">37</span> <span class="mi">77</span> <span class="mi">89</span> <span class="mi">22</span> <span class="mi">63</span> <span class="mi">9</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">len_win</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">dout</span> <span class="p">=</span> <span class="n">movmean</span><span class="p">(</span><span class="n">din</span><span class="p">,</span><span class="n">len_win</span><span class="p">);</span>
<span class="c">% the kth output uses the kth input as the center of the window</span>
<span class="n">dout</span> <span class="p">=</span> <span class="n">dout</span><span class="p">(</span><span class="nb">ceil</span><span class="p">(</span><span class="n">len_win</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span><span class="k">end</span><span class="p">);</span>
<span class="nb">disp</span><span class="p">(</span><span class="n">dout</span><span class="p">);</span>
<span class="c">% Display the Result of Slide Average</span>
<span class="n">figure</span><span class="p">;</span> <span class="n">hold</span> <span class="n">on</span>
<span class="n">plot</span><span class="p">(</span><span class="n">len_win</span> <span class="o">+</span> <span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">dout</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">dout</span><span class="p">,</span><span class="s">&#39;-o&#39;</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">din</span><span class="p">),</span><span class="n">din</span><span class="p">,</span><span class="s">&#39;-o&#39;</span><span class="p">);</span>
<span class="n">xlim</span><span class="p">([</span><span class="mi">1</span> <span class="n">len_win</span><span class="o">+</span><span class="nb">length</span><span class="p">(</span><span class="n">dout</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</td></tr></table>

<p>使用滑动窗口计算平均的结果如下图所示，在输入数据中原本存在许多突变的点，这些点在滑动平均操作后都变得更加平滑了。考虑在时间序列中，突变的点对应高频的信号，因此滑动平均操作可以消除输入序列中的高频分量。通过滑动平均操作，我们实现了过滤高频分量、保留低频分量的目标，即实现了一个简单的低通滤波器。</p>
<p><img alt="滑动窗口计算平均的结果" src="../res/基础概念/滤波/avgfig.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 滑动窗口计算平均的结果</div>
</center></p>
<p>在上面的这个例子中，直到输入前五个点后，滑动窗口才在**时刻5**输出了第一个滑动平均的结果，即</p>
<div>
<div class="MathJax_Preview">
y_{avg}(5) = \frac{1}{5}[x(1)+x(2)+x(3)+x(4)+x(5)]
</div>
<script type="math/tex; mode=display">
y_{avg}(5) = \frac{1}{5}[x(1)+x(2)+x(3)+x(4)+x(5)]
</script>
</div>
<p>对于更一般的情况，**时刻n**的输出<span><span class="MathJax_Preview">y_{avg}(n)</span><script type="math/tex">y_{avg}(n)</script></span>，我们可以将其表示为：</p>
<div>
<div class="MathJax_Preview">
y_{avg}(n) = \frac{1}{5}[x(n-4)+x(n-3)+x(n-2)+x(n-1)+x(n)]=\frac{1}{5}\sum_{k=n-4}^{n}x(k)
</div>
<script type="math/tex; mode=display">
y_{avg}(n) = \frac{1}{5}[x(n-4)+x(n-3)+x(n-2)+x(n-1)+x(n)]=\frac{1}{5}\sum_{k=n-4}^{n}x(k)
</script>
</div>
<p>从上式可以看出，每个滑动窗口内的平均计算，可以理解为对窗口内所有输入值求和后再除以窗口长度（如下图所示）。</p>
<p><img alt="求和后平均" src="../res/基础概念/滤波/avg1.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 求和后平均</div>
</center></p>
<p>如果我们根据乘法分配律，将乘系数的操作移到求和之前，在滑动窗口内的平均计算就变成了对输入数据的加权求和。只不过在这个例子中，所有输入的权重都是相同的（即<span><span class="MathJax_Preview">\frac{1}{5}</span><script type="math/tex">\frac{1}{5}</script></span>）。</p>
<p><img alt="加权求和" src="../res/基础概念/滤波/avg2.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 加权求和</div>
</center></p>
<p>在实际的滤波器中，对输入数据加权求和时，每个输入的权重并不一定都要相同，即我们可以为窗口中不同的数据指派不同的权重。如果我们用<span><span class="MathJax_Preview">h(k)</span><script type="math/tex">h(k)</script></span>表示窗口中第k个输入<span><span class="MathJax_Preview">x(n-k)</span><script type="math/tex">x(n-k)</script></span>的权重，则**时刻n**的输出<span><span class="MathJax_Preview">y(n)</span><script type="math/tex">y(n)</script></span>可以表示为：</p>
<div>
<div class="MathJax_Preview">
y(n)=h(4)x(n-4)+h(3)x(n-3)+h(2)x(n-2)+h(1)x(n-1)+h(0)x(n)=\sum_{k=0}^4h(k)x(n-k)
</div>
<script type="math/tex; mode=display">
y(n)=h(4)x(n-4)+h(3)x(n-3)+h(2)x(n-2)+h(1)x(n-1)+h(0)x(n)=\sum_{k=0}^4h(k)x(n-k)
</script>
</div>
<p>更一般的，如果我们使用的滑动窗口的长度为<span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>，则时刻n的输出为：</p>
<div>
<div class="MathJax_Preview">
y(n)=\sum_{k=0}^{M}h(k)x(n-k)
</div>
<script type="math/tex; mode=display">
y(n)=\sum_{k=0}^{M}h(k)x(n-k)
</script>
</div>
<p>我们称上述加权的系数为滤波器系数（Filter Coefficients）。在后面的介绍中我们会了解到，正是滤波器系数<span><span class="MathJax_Preview">h(k)</span><script type="math/tex">h(k)</script></span>和窗口长度<span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>共同决定了滤波器的最终工作效果。接下来，我们先来看看我们通过滑动平均实现的低通滤波器实际工作效果究竟如何。</p>
<p>为了简化后面的计算过程，我们直接观察连续信号滑动平均的结果。设输入信号为<span><span class="MathJax_Preview">x(t)</span><script type="math/tex">x(t)</script></span>，滑动窗口的长度为<span><span class="MathJax_Preview">T_w</span><script type="math/tex">T_w</script></span>，则对其进行滑动平均后输出<span><span class="MathJax_Preview">y(t)</span><script type="math/tex">y(t)</script></span>可以表示为：</p>
<div>
<div class="MathJax_Preview">
y(t)=\frac{1}{T_{w}} \int_{t-T_{w} / 2}^{t+T_{w} / 2} x(t) d t
</div>
<script type="math/tex; mode=display">
y(t)=\frac{1}{T_{w}} \int_{t-T_{w} / 2}^{t+T_{w} / 2} x(t) d t
</script>
</div>
<p>对于初始条件为零的系统，其频率响应函数<span><span class="MathJax_Preview">H(\omega)</span><script type="math/tex">H(\omega)</script></span>等于输出<span><span class="MathJax_Preview">y(t)</span><script type="math/tex">y(t)</script></span>和输入<span><span class="MathJax_Preview">x(t)</span><script type="math/tex">x(t)</script></span>的傅里叶变换结果<span><span class="MathJax_Preview">Y(\omega)</span><script type="math/tex">Y(\omega)</script></span>,<span><span class="MathJax_Preview">X(\omega)</span><script type="math/tex">X(\omega)</script></span>之比，即</p>
<div>
<div class="MathJax_Preview">
H(\omega)=\frac{Y(\omega)}{X(\omega)}
</div>
<script type="math/tex; mode=display">
H(\omega)=\frac{Y(\omega)}{X(\omega)}
</script>
</div>
<p>设输入函数<span><span class="MathJax_Preview">x(t) = cos(\omega t) = cos(2\pi ft)</span><script type="math/tex">x(t) = cos(\omega t) = cos(2\pi ft)</script></span>，则<span><span class="MathJax_Preview">x(t)</span><script type="math/tex">x(t)</script></span>傅里叶变换的结果<span><span class="MathJax_Preview">X(\omega)=FFT(x(t))=1</span><script type="math/tex">X(\omega)=FFT(x(t))=1</script></span>，而<span><span class="MathJax_Preview">y(t)</span><script type="math/tex">y(t)</script></span>傅里叶变换的结果：</p>
<div>
<div class="MathJax_Preview">
Y(\omega)=\frac{\sin \omega T_{w} / 2}{\omega T_{w} / 2}=\frac{\left|\sin \pi f T_{w}\right|}{\pi f T_{w}}
</div>
<script type="math/tex; mode=display">
Y(\omega)=\frac{\sin \omega T_{w} / 2}{\omega T_{w} / 2}=\frac{\left|\sin \pi f T_{w}\right|}{\pi f T_{w}}
</script>
</div>
<p>因此频率响应函数为：</p>
<div>
<div class="MathJax_Preview">
|H(\omega)|=\left|\frac{Y(\omega)}{X(\omega)}\right|=\frac{|Y(\omega)|}{1}=\frac{\left|\sin \omega T_{w} / 2\right|}{\omega T_{w} / 2}
</div>
<script type="math/tex; mode=display">
|H(\omega)|=\left|\frac{Y(\omega)}{X(\omega)}\right|=\frac{|Y(\omega)|}{1}=\frac{\left|\sin \omega T_{w} / 2\right|}{\omega T_{w} / 2}
</script>
</div>
<p>显然<span><span class="MathJax_Preview">H(\omega)</span><script type="math/tex">H(\omega)</script></span>是一个sinc函数。接下来，我们来看看滑动平均滤波器的截止频率<span><span class="MathJax_Preview">f_{co}</span><script type="math/tex">f_{co}</script></span>是多少。</p>
<p>规定滤波器的截止增益为-3db，即衰减倍率为0.707，根据<span><span class="MathJax_Preview">sinc(x)</span><script type="math/tex">sinc(x)</script></span>特性曲线，求解<span><span class="MathJax_Preview">sinc(x)=0.707</span><script type="math/tex">sinc(x)=0.707</script></span>，可得<span><span class="MathJax_Preview">x = 1.3917</span><script type="math/tex">x = 1.3917</script></span>。代入到<span><span class="MathJax_Preview">H(w)</span><script type="math/tex">H(w)</script></span>中，可得<span><span class="MathJax_Preview">x=\frac{\omega T_{w}}{2}=\pi f_{c o} T_{w}=1.3917</span><script type="math/tex">x=\frac{\omega T_{w}}{2}=\pi f_{c o} T_{w}=1.3917</script></span>，即</p>
<div>
<div class="MathJax_Preview">
T_w = \frac{0.443}{f_{co}}
</div>
<script type="math/tex; mode=display">
T_w = \frac{0.443}{f_{co}}
</script>
</div>
<p>其中<span><span class="MathJax_Preview">T_w</span><script type="math/tex">T_w</script></span>为平均宽度，采样率已知的情况下，<span><span class="MathJax_Preview">T_w</span><script type="math/tex">T_w</script></span>的大小取决于窗口中采样点的数量<span><span class="MathJax_Preview">T_w = \frac{N}{f_s}</span><script type="math/tex">T_w = \frac{N}{f_s}</script></span>。由此，滑动平均滤波的点数与截止频率之间的关系可以表达为：</p>
<div>
<div class="MathJax_Preview">
f_{co} = 0.443\times \frac{f_s}{N}
</div>
<script type="math/tex; mode=display">
f_{co} = 0.443\times \frac{f_s}{N}
</script>
</div>
<!-- MATLAB仿真，观察滑动平均滤波的脉冲响应 -->

<p>我们还可以使用MATLAB仿真，观察滑动平均滤波器的脉冲响应。理想情况下，脉冲信号包含所有频率的谐波分量，因此我们使用滑动平均滤波器对脉冲信号进行滤波，然后对滤波器的输出做傅里叶变换，在频域上观察滤波器的滤波效果：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">%% 滑动平均滤波的脉冲响应</span>
<span class="c">% 构造单位脉冲信号</span>
<span class="n">din</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e4</span><span class="p">);</span>
<span class="n">din</span><span class="p">(</span><span class="mf">5e3</span><span class="p">)</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">figure</span><span class="p">;</span><span class="n">plot</span><span class="p">(</span><span class="n">din</span><span class="p">);</span>
<span class="c">% 脉冲信号包含所有频率的谐波分量</span>
<span class="n">z</span> <span class="p">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">din</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">length</span><span class="p">(</span><span class="n">din</span><span class="p">));</span>
<span class="n">figure</span><span class="p">;</span>
    <span class="n">plot</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">));</span>
<span class="c">% 使用滑动平均滤波器对脉冲信号滤波    </span>
<span class="n">len_win</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">dout</span> <span class="p">=</span> <span class="n">movmean</span><span class="p">(</span><span class="n">din</span><span class="p">,</span><span class="n">len_win</span><span class="p">);</span>
<span class="c">% 对滤波后结果做傅里叶变换，在频域上观察滤波效果</span>
<span class="n">z</span> <span class="p">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">dout</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">length</span><span class="p">(</span><span class="n">dout</span><span class="p">));</span>
<span class="n">hold</span> <span class="n">on</span>
    <span class="n">plot</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">));</span>
<span class="c">% 调整滑动窗口的大小</span>
<span class="n">len_win</span> <span class="p">=</span> <span class="mi">15</span><span class="p">;</span>
<span class="n">dout</span> <span class="p">=</span> <span class="n">movmean</span><span class="p">(</span><span class="n">din</span><span class="p">,</span><span class="n">len_win</span><span class="p">);</span>
<span class="n">z</span> <span class="p">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">dout</span><span class="p">,</span><span class="mi">100</span><span class="o">*</span><span class="nb">length</span><span class="p">(</span><span class="n">dout</span><span class="p">));</span>
    <span class="n">plot</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">));</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Frequency&#39;</span><span class="p">);</span>
<span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;abs. FFT&#39;</span><span class="p">);</span>
<span class="n">grid</span> <span class="n">on</span><span class="p">;</span>
<span class="n">grid</span> <span class="n">minor</span>
<span class="n">box</span> <span class="n">on</span>
</pre></div>
</td></tr></table>

<p><img alt="不同窗口长度下，滑动平均滤波器的脉冲响应" src="../res/基础概念/滤波/脉冲响应.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 不同窗口长度下，滑动平均滤波器的脉冲响应</div>
</center></p>
<p>通过滑动平均滤波，低频信号分量被保留下来，而高频分量得到了有效的抑制。由于滤波保留的低频信号包含正频率和负频率，而绘图时只绘制了<span><span class="MathJax_Preview">[0,f_s]</span><script type="math/tex">[0,f_s]</script></span>部分的频谱，因此波峰在图中被分成了两半。</p>
<p><strong>(FIR的脉冲响应就是它的滤波器系数)</strong></p>
<p>到现在，我们已经知道滤波器的基本工作方式，是使用滑动窗口对输入信号依次加权求，窗口的大小以及滤波器系数直接决定最终的滤波效果。现在的问题是，给定滤波要求，对任意一组输入，我们要如何确定窗口长度<span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>和滤波器系数<span><span class="MathJax_Preview">h(k)</span><script type="math/tex">h(k)</script></span>？</p>
<p>仔细观察滑动窗口内加权求和的计算操作，我们可以发现上述求和过程实际上是输入向量<span><span class="MathJax_Preview">x(n)</span><script type="math/tex">x(n)</script></span>与系数向量<span><span class="MathJax_Preview">h(k)</span><script type="math/tex">h(k)</script></span>的卷积！即：</p>
<div>
<div class="MathJax_Preview">
y(n)=\sum_{k=0}^{M}h(k)x(n-k)=h(k)*x(n)
</div>
<script type="math/tex; mode=display">
y(n)=\sum_{k=0}^{M}h(k)x(n-k)=h(k)*x(n)
</script>
</div>
<p>这一发现有很重要的意义！因为我们知道对于傅里叶变换和逆傅里叶变换这一类线性系统，在一个域上的卷积等于变换到另一个域上的点乘。</p>
<p><img alt="" src="../res/基础概念/滤波/fft.jpg" /></p>
<p>因此，令时域信号与滤波器系数做卷积，其效果等价于：使用滤波器系数<span><span class="MathJax_Preview">h(n)</span><script type="math/tex">h(n)</script></span>做DFT的结果<span><span class="MathJax_Preview">H(m)</span><script type="math/tex">H(m)</script></span>，在频域上直接与目标信号做点乘滤波。理想情况下，我们希望<span><span class="MathJax_Preview">H(m)</span><script type="math/tex">H(m)</script></span>在我们希望的频率处值为<span><span class="MathJax_Preview">1</span><script type="math/tex">1</script></span>，而在我们希望过滤掉的频率处值为<span><span class="MathJax_Preview">0</span><script type="math/tex">0</script></span>。而实际上，我们在上面例子中所描述的简单低通滤波器与理想情况相距甚远。回想一下，我们在上文所描述的滤波器，使用一个长度为5的滑动窗口，滤波器系数全部设为<span><span class="MathJax_Preview">\frac{1}{5}</span><script type="math/tex">\frac{1}{5}</script></span>，即<span><span class="MathJax_Preview">h(k)=[\frac{1}{5} \frac{1}{5} \frac{1}{5} \frac{1}{5} \frac{1}{5}]</span><script type="math/tex">h(k)=[\frac{1}{5} \frac{1}{5} \frac{1}{5} \frac{1}{5} \frac{1}{5}]</script></span>。对这样一个系数向量做DFT，显然我们将在频域上得到一个以频率0为中心、由一个主瓣和若干旁瓣共同组成的类sinc波（如下图实线所示），这与我们期望的理想滤波器（虚线所示）相差甚远。</p>
<p><img alt="滑动平均在频域上的效果" src="../res/基础概念/滤波/dft.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 滑动平均在频域上的效果</div>
</center></p>
<p>这样的低通滤波器，显然无法完全消除所有高于频率阈值的信号分量，同时也会导致低于阈值的有效信号发生变形。</p>
<p><img alt="非完美滤波器效果" src="../res/基础概念/滤波/filter2.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 非完美滤波器效果</div>
</center></p>
<p>上图可以看到，由于窗口长度和滤波器系数选择的不合理（全部都是<span><span class="MathJax_Preview">\frac{1}{5}</span><script type="math/tex">\frac{1}{5}</script></span>），简单低通滤波器的滤波效果并不理想。那么，我们要如何确定窗口长度<span><span class="MathJax_Preview">M</span><script type="math/tex">M</script></span>和滤波器系数<span><span class="MathJax_Preview">h(k)</span><script type="math/tex">h(k)</script></span>，使得滤波器的效果尽可能好呢？</p>
<p>一个直观的想法是先在频域上构造理想波形，即构造频域上的矩形波，在目标频率范围为1，其他频率处为0。然后对频域构造的结果做逆傅里叶变换，得到我们想要的滤波器系数。但这个想法要付诸实际，还面临着一个挑战：频域上，理想滤波器在除目标频率范围外的所有频率处都为0，因此其长度为无限长，经过逆傅里叶变换后，得到时域的滤波器系数也将会是无限长的。但考虑到实际信号处理中使用的都是有限长度信号，因此理想滤波器在实际中无法实现。</p>
<p><img alt="理想低通滤波器要求无限长度的滤波器系数向量" src="../res/基础概念/滤波/ideal.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 理想低通滤波器要求无限长度的滤波器系数向量</div>
</center></p>
<p>在继续介绍滤波器实现之前，我们先来明确一组等价的概念：滤波器长度=滑动窗口长度=滤波抽头长度=滤波器系数向量长度，这几个看似不同的说法经常出现在各种与滤波器相关的资料中，但他们所表达的含义是一样的。给定一组真实信号输入，显然滤波器的长度是有限的。且考虑长度为n的滤波器会抽除输入信号头部n个数据点，因此滤波器长度应该要远小于输入信号的长度。</p>
<p>实际滤波时，我们通常对理想滤波器逆傅里叶变换截取一段有限长度的结果，用作滤波器系数。如下图所示，随着滤波器系数长度的增加，其傅里叶变换的结果约接近理想滤波器。同时，我们也发现DFT结果中，接近频率阈值处存在振幅抖动，这就是我们常说的吉布斯效应。为了消除吉布斯效应，并使通频带外信号得到更好的抑制，学者们提出了许多不同的加窗策略，这又是另一个非常有趣的主题，有兴趣的同学可以在课后自行了解。</p>
<p><img alt="" src="../res/基础概念/滤波/filter-len.jpg" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. 不同窗口长度</div>
</center></p>
<!-- 滤波器（Filter），顾名思义，是对波进行过滤的器件。广义上，任何对信号中特定频率做出改变的系统都可以称之为滤波器，因而滤波器有着极为丰富的含义，从Wikipedia上涉及各领域的长长的滤波器词条列表可窥见一斑。

下文所讨论的滤波器将限于信号处理领域。 -->

<p>除了上面介绍的简单滤波器之外，滤波器有很多不同的种类。现有对滤波器的分类有很多重叠，因此很难对滤波器进行简单的层次分类。各种不同的角度包括：</p>
<ul>
<li>线性或非线性</li>
<li>时变或时不变</li>
<li>因果或非因果</li>
<li>模拟或数字</li>
<li>离散或连续</li>
<li>有限脉冲响应类型（FIR）或者无限脉冲响应类型（IIR）</li>
<li>...</li>
</ul>
<p>在信号处理中，通常情况下滤波器用于选择/去除一些频率/频段，因此可以认为是一个频率选择器。按所通过信号的频段不同，信号处理常用的滤波器可以分为低通、高通、带通和带阻滤波器：</p>
<ul>
<li>低通滤波器（low-pass filter, LPF）：它允许信号中的低频或直流分量通过，抑制高频分量或干扰和噪声。</li>
<li>高通滤波器（high-pass filter, HPF）：它允许信号中的高频分量通过，抑制低频或直流分量。</li>
<li>带通滤波器（band-pass filter, BPF）：它允许一定频段的信号通过，抑制低于或高于该频段的信号、干扰和噪声。</li>
<li>带阻滤波器（band-stop filter, BSF）：它抑制一定频段内的信号，允许该频段以外的信号通过。</li>
</ul>
<!-- 一个理想滤波器可让某一频带的信号完全通过，并将其余频率范围的信号完全滤除，其中信号完全通过的频率范围称为通带(passband)，而信号完全滤除的频率范围称为阻带(stopband)。理想的滤波器在通带增益为1阻带增益为0。非理想滤波器在通带与阻带之间无法瞬间切换，其衰减程度(增益)随频率连续变化，因此有过渡带(transition band)的存在，而且阻带的增益也无法达到0。

<img src="./images/4.2/cpt_lowpass.png" width=600px>

<img src="./images/4.2/cpt_linear_filters.png" width=600px> -->

<p>最后，请大家利用MATLAB自带的<code>filter()</code>函数，尝试对输入信号进行滤波：</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">fs</span> <span class="p">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c">% sampling frequency</span>
<span class="n">t</span> <span class="p">=</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span>
<span class="n">x</span> <span class="p">=</span> <span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">pi</span><span class="o">*</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">awgn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&#39;measured&#39;</span><span class="p">);</span> <span class="c">% snr = 10dB</span>

<span class="n">windowSize</span> <span class="p">=</span> <span class="mi">5</span><span class="p">;</span> 
<span class="n">b</span> <span class="p">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">windowSize</span><span class="p">)</span><span class="o">*</span><span class="nb">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">windowSize</span><span class="p">);</span>
<span class="n">a</span> <span class="p">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">z</span> <span class="p">=</span> <span class="n">filter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>

<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">y</span><span class="p">;</span> <span class="n">z</span><span class="p">]);</span>
<span class="n">legend</span><span class="p">(</span><span class="s">&#39;Input Data&#39;</span><span class="p">,</span><span class="s">&#39;Filtered Data&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p><img alt="" src="../res/基础概念/cpt_filter.png" />
<center>
<div style="color:orange; border-bottom: 1px solid #d9d9d9;
display: inline-block;
color: #999;
padding: 2px;">图. MATLAB低通滤波效果</div>
</center></p>
<p><strong>思考</strong></p>
<ol>
<li>移动平均计算看似简单，但是却是一个十分耗时的计算，尤其平均点数较多后格外明显。请思考是否有办法提高移动平均计算的效率？</li>
<li>如何在低通滤波器的基础上，实现高通滤波器、带通滤波器、带阻滤波器？</li>
</ol>
<h1 id="_2">参考<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<ol>
<li>Zheng Yang, Zimu Zhou, and Yunhao Liu. 2013. From RSSI to CSI: Indoor localization via channel response. <em>ACM Comput. Surv.</em> 46, 2, Article 25 (December 2013), 32 pages. DOI: <a href="https://doi.org/10.1145/2543581.2543592">https://doi.org/10.1145/2543581.2543592</a></li>
<li>《古今数学思想（第三册）》第28章</li>
<li>《信号与系统（第二版）》第3、4、5章</li>
<li>《离散时间信号处理（第三版）》第7章</li>
<li><a href="https://zh.wikipedia.org/wiki/Communication_channel">Wikipedia/Communication_channel</a></li>
<li><a href="https://en.wikipedia.org/wiki/Multipath_propagation">Wikipedia/Multipath</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Fading">Wikipedia/Fading</a></li>
<li><a href="https://en.wikipedia.org/wiki/Channel_state_information">Wikipedia/Channel_state_information</a></li>
<li><a href="https://zh.wikipedia.org/wiki/Fast_Fourier_transform">Wikipedia/Fast_Fourier_transform</a></li>
<li><a href="https://en.wikipedia.org/wiki/Fourier_transform">Wikipedia/Fourier_transform</a></li>
<li><a href="https://en.wikibooks.org/wiki/Communication_Systems/Fading_Channels">Wikibooks/Fading_Channels</a></li>
<li><a href="https://en.wikipedia.org/wiki/Filter">Wikipedia/Filter</a></li>
<li><a href="https://en.wikipedia.org/wiki/Filter_(signal_processing)">Wikipedia/Filter_(signal_processing)</a></li>
<li><a href="https://baike.baidu.com/item/相干带宽">百度百科/相干带宽</a></li>
<li><a href="https://baike.baidu.com/item/滤波器">百度百科/滤波器</a></li>
<li>Understanding Digital Signal Processing, Third Edition, Richard G. Lyons, Pearson Education</li>
<li>滑动平均滤波的截止频率与平均点数计算, <a href="https://www.cnblogs.com/pingwen/p/6670675.html">https://www.cnblogs.com/pingwen/p/6670675.html</a></li>
</ol>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../3. 物联网通信协议/LoRa编码和通信实验/" title="4.3 LoRa编码和通信实验" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                4.3 LoRa编码和通信实验
              </span>
            </div>
          </a>
        
        
          <a href="../4.2 调制解调方法及其声音实现/" title="5.2 调制解调方法" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                5.2 调制解调方法
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/iot-book" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
    <script src="../../../assets/javascripts/application.6f02ae1b.js"></script>
      
        
        
          
          <script src="../../../assets/javascripts/lunr../../../lunr.stemmer.support.js"></script>
          
            
              
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../../../../js/extra.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
    
  </body>
</html>